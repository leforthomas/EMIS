var googleMapsV3=(function(){var h,b;function c(){}c.createMap=function(n,k,m,l,p,o,j){if(p==undefined){if(j){j("No valid div element provided")}}if(google&&google.maps){h=google.maps;b=h.event;new c.map2D(p,n,k,m,l,o,j)}else{if(j){j("Could not load google maps library.")}}};c.setListener=function(j,k,l){if(l==null){google.maps.event.clearListeners(j,k)}else{google.maps.event.addListener(j,k,l)}};c.interpolateJSNI=function(o,n,m,l,j,k){return c.interpolate(new google.maps.LatLng(o,n),new google.maps.LatLng(m,l),j,k)};c.interpolate=function(o,l,j,m){if(m==false){var n=(o.lat()+l.lat())/j;var k=o.lng()-l.lng();if(k<=180&&k>=-180){k=(o.lng()+l.lng())/j}else{k=(o.lng()+l.lng()+360)/j}return new google.maps.LatLng(n,k)}else{return google.maps.geometry.spherical.interpolate(o,l,j)}};c.halfWayTo=function(l,j,k){return c.interpolate(l,j,0.5,k)};c.roundDistance=function(j){if(j>1000){return Math.round(j/1000)+"km"}else{if(j<=1000){return Math.round(j)+"m"}}return j};c.convertBounds=function(j){return{swLat:j.getSouthWest().lat(),swLng:j.getSouthWest().lng(),neLat:j.getNorthEast().lat(),neLng:j.getNorthEast().lng()}};c._getMarkersBounds=function(l){var k=new google.maps.LatLngBounds();var j;for(j=0;j<l.length;j++){k.extend(l[j].getPosition())}return k};c._getMarkersCenter=function(k){var j=c._getMarkersBounds(k);return j.getCenter()};c._getPathBounds=function(l){var k=new google.maps.LatLngBounds();var j;l.forEach(function(n,m){k.extend(n)});return k};c._getPathCenter=function(j){return c._getPathBounds(j).getCenter()};c.generatePath=function(j){var k=new google.maps.MVCArray;for(i=0;i<j.length;){k.insertAt(k.getLength(),new google.maps.LatLng(j[i],j[i+1]));i=i+2}return k};c.convertPath=function(j){var k=[];j.forEach(function(m,l){k.push(m.lat());k.push(m.lng())});return k};c.getPathLength=function(j){return google.maps.geometry.spherical.computeLength(c.generatePath(j))};c.getPathArea=function(j){return google.maps.geometry.spherical.computeArea(c.generatePath(j))};c.defaultDragMarker={url:"./img/dragIcon.png",shiftX:5,shiftY:5};c.defaultEditMarker={url:"./img/dragIconLight.png",shiftX:5,shiftY:5};function g(k){function j(l){h.Rectangle.call(this,{bounds:new h.LatLngBounds(new h.LatLng(-89.9,-179.99999),new h.LatLng(89.9,179.99999)),map:l,strokeOpacity:0,fillOpacity:0,zIndex:10000})}j.prototype=new h.Rectangle();return new j(k)}c.map2D=(function(){function j(o,r,s,v,t,u,q){var p=new h.LatLng(r,s);this.mapTypeIds=[h.MapTypeId.ROADMAP,h.MapTypeId.HYBRID,h.MapTypeId.SATELLITE,h.MapTypeId.TERRAIN];if(!t||this.mapTypeIds.indexOf(t)==-1){t=h.MapTypeId.HYBRID}var w={zoom:v,minZoom:1,center:p,streetViewControl:false,panControl:false,zoomControl:true,zoomControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},mapTypeControlOptions:{mapTypeIds:this.mapTypeIds,style:h.MapTypeControlStyle.DROPDOWN_MENU},mapTypeControl:false,scaleControl:true,scaleControlOptions:{position:h.ControlPosition.BOTTOM_LEFT},rotateControl:true,fullscreenControl:false,mapTypeId:t?t:h.MapTypeId.HYBRID};var m=new h.Map(o,w);m.setTilt(0);this.infoWindow=new h.InfoWindow({content:"Not Initialised!",maxWidth:400});k(m);l(m);this.geocoder=new h.Geocoder();this.overlaysArray=[];this.theTooltip=n(m);this.zIndex=0;this.map=m;u(this)}function n(o){function m(p){this.div_=null;this.setMap(p)}m.prototype=new h.OverlayView();m.prototype.onAdd=function(){var s=document.createElement("DIV");s.className="twipsy below";s.style.width="120px";s.style.fontSize="9px";this.div_=s;var q=document.createElement("DIV");q.className="twipsy-arrow";s.appendChild(q);var r=document.createElement("DIV");r.className="twipsy-inner";s.appendChild(r);this.title_=r;var p=this.getPanes();p.overlayImage.appendChild(s);this.hide()};m.prototype.draw=function(){};m.prototype.show=function(t,r){if(this.div_==null){return}var q=this.getProjection();var p=q.fromLatLngToDivPixel(t);this.title_.innerHTML=r;var s=this.div_;s.style.left=p.x-60+"px";s.style.top=p.y+20+"px";s.style.display="block"};m.prototype.hide=function(){this.div_.style.display="none"};m.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);this.div_=null};return new m(o)}function l(m){}function k(p){function m(q){this.setMap(q)}m.prototype=new h.OverlayView;m.prototype.onAdd=function(){};m.prototype.onRemove=function(){};m.prototype.draw=function(){};if(!p.dummyCanvas){function o(r){var s=0;var q=0;if(r.offsetParent){do{s+=r.offsetLeft;q+=r.offsetTop}while(r=r.offsetParent)}return{x:s,y:q}}p.dummyCanvas=new m(p);p.getMapCanvasProjection=function(){return this.dummyCanvas.getProjection()};p.convertScreenPositionToLatLng=function(u,t){var q=p.getDiv();var s=o(q);var r=p.getMapCanvasProjection().fromContainerPixelToLatLng(new h.Point(u-s.x,t-s.y));return r};p.convertLatLngToScreenPosition=function(t,s){var r=p.getDiv();var u=o(r);var q=p.getMapCanvasProjection().fromLatLngToContainerPixel(new h.LatLng(t,s));q.x+=u.x;q.y+=u.y;return q}}}j.prototype.addZoomOnShift=function(p){var m=this;var o=this.map;o.getDiv().parentElement.addEventListener("mousedown",function(r){if(r.shiftKey){r.preventDefault();r.stopPropagation();var u=g(o);b.clearInstanceListeners(u);var x=o.convertScreenPositionToLatLng(r.clientX,r.clientY);var w=new h.Polygon({map:o,strokeColor:"#ff0000",strokeWeight:1,strokeOpacity:1,fillColor:"#ffffff",fillOpacity:0});var y=new h.MVCArray;w.setPaths(new h.MVCArray([y]));function q(A,z){c.uniRectangle.refreshPath(y,A,z)}function v(B){var A=B.latLng;var z=x;q(A,z);m.theTooltip.show(B.latLng,"<p>Position: "+B.latLng.toUrlValue(4)+"</p><p>Release to zoom to extent</p>")}function s(B){var C=90;var z=180;var D=-90;var A=-180;w.getPaths().forEach(function(E){E.getArray().forEach(function(F){if(F.lat()<C){C=F.lat()}if(F.lat()>D){D=F.lat()}if(F.lng()<z){z=F.lng()}if(F.lng()>A){A=F.lng()}})});p(C,z,D,A);t()}function t(){w.setMap(null);b.clearInstanceListeners(u);u.setMap(null);delete u;m.theTooltip.hide();m.editCleanUp=null}m.editCleanUp=t;q(x,x);b.addListener(u,"mousemove",v);b.addListener(u,"mouseup",s)}},true)};j.prototype.displayCopyright=function(m,q){if(!m||m==null||m.length==0){return}if(!this.copyrightHolder){var r=document.createElement("div");r.className="eiCopyrightHolder";this.map.controls[h.ControlPosition.BOTTOM_RIGHT].push(r);this.copyrightHolder=r}if(q){var o=!this.copyrightHolder.innerHTML||this.copyrightHolder.innerHTML.length==0;if(o||this.copyrightHolder.innerHTML.indexOf(m)==-1){this.copyrightHolder.innerHTML+=(o?"":", ")+m}}else{var p=this.copyrightHolder.innerHTML.indexOf(m)==0;this.copyrightHolder.innerHTML=this.copyrightHolder.innerHTML.replace((p?"":", ")+m,"")}};j.prototype.convertScreenPositionToLatLng=function(p,o){var m=this.map.convertScreenPositionToLatLng(p,o);return{lat:m.lat(),lng:m.lng()}};j.prototype.convertLatLngToScreenPosition=function(o,m){return this.map.convertLatLngToScreenPosition(o,m)};j.prototype.disableAllEditMode=function(){var m;for(m=0;m<this.overlaysArray.length;m++){if(typeof this.overlaysArray[m].setEditMode=="function"&&this.overlaysArray[m].isEditable()===true){this.overlaysArray[m].setEditMode(false)}}};j.prototype.triggerResize=function(){b.trigger(this.map,"resize")};j.prototype.showOverview=function(m){this.map.setOptions({overviewMapControl:m})};j.prototype.showFullscreen=function(m){var o=(m=="true");this.map.setOptions({fullscreenControl:o})};j.prototype.showZoom=function(m){var o=(m=="true");this.map.setOptions({zoomControl:o})};j.prototype.setCenter=function(o,m){this.map.setCenter(new h.LatLng(o,m))};j.prototype.getCenter=function(){var m=this.map.getCenter();return[m.lat(),m.lng()]};j.prototype.setZoomLevel=function(m){this.map.setZoom(m)};j.prototype.getZoomLevel=function(){return this.map.getZoom()};j.prototype.addControl=function(p,m){var o=h.ControlPosition.TOP_RIGHT;if(m){if(m=="topLeft"){o=h.ControlPosition.LEFT_TOP}if(m=="leftCenter"){o=h.ControlPosition.LEFT_CENTER}if(m=="bottomLeft"){o=h.ControlPosition.LEFT_BOTTOM}if(m=="bottomCenter"){o=h.ControlPosition.BOTTOM_CENTER}if(m=="bottomRight"){o=h.ControlPosition.BOTTOM_RIGHT}if(m=="rightBottom"){o=h.ControlPosition.RIGHT_BOTTOM}if(m=="rightCenter"){o=h.ControlPosition.RIGHT_CENTER}if(m=="rightTop"){o=h.ControlPosition.RIGHT_TOP}if(m=="topRight"){o=h.ControlPosition.TOP_RIGHT}if(m=="topCenter"){o=h.ControlPosition.TOP_CENTER}}this.map.controls[o].push(p)};j.prototype.setBounds=function(p,m,q,o){this.map.fitBounds(new h.LatLngBounds(new h.LatLng(p,m),new h.LatLng(q,o)))};j.prototype.getMapId=function(){return this.map.getMapTypeId()};j.prototype.setClickListener=function(m){if(m!=null){c.setListener(this.map,"click",function(o){m(o.latLng.lat(),o.latLng.lng())})}else{c.setListener(this.map,"click",null)}};j.prototype.setMapId=function(o){if(o&&o!=""&&o!=null&&this.map.mapTypes.get(o)){var m=this.map.getMapTypeId();if(m){var p=this.map.mapTypes.get(m);if(p&&p.displayCopyright){p.displayCopyright(false)}}this.map.setMapTypeId(o);var q=this.map.mapTypes.get(o);if(q.displayCopyright){q.displayCopyright(true)}}else{this.map.setMapTypeId(google.maps.MapTypeId.SATELLITE)}};j.prototype.cleanUp=function(){if(this.overlaysArray){var m;for(m=0;m<this.overlaysArray.length;m++){this.removeOverlay(this.overlaysArray[m])}}this.overlaysArray=[];this.closeInfoWindow();if(this.editCleanUp){this.editCleanUp()}};j.prototype.addMapType=function(s,q,t,p,r,u,m){var o;o=(new c.uniTMSLayer(this,t,p,r,-90,-180,90,180,true))._layer;o.minZoom=u;o.maxZoom=m;o.name=s;o.alt=s;this.mapTypeIds.push(q);this.map.mapTypes.set(q,o)};j.prototype.addWMSMapType=function(s,z,o,u,r,t,B,q,v,w,y,A,m,x){var p;p=(new c.uniWMSLayer(this,o,u,r,t,B,q,v,w,y,A,true))._layer;p.minZoom=m==undefined?0:m;p.maxZoom=x==undefined?15:x;p.name=s;p.alt=s;this.mapTypeIds.push(z);this.map.mapTypes.set(z,p)};j.prototype.getMapTypeIds=function(){return this.mapTypeIds};j.prototype.openInfoWindow=function(p,m,o){this.infoWindow.setContent(o);this.infoWindow.open(this.map);this.infoWindow.setPosition(new h.LatLng(p,m))};j.prototype.openInfoWindowWidget=function(p,m,o){this.infoWindow.setContent(o);this.infoWindow.open(this.map);this.infoWindow.setPosition(new h.LatLng(p,m))};j.prototype.closeInfoWindow=function(){this.infoWindow.close()};j.prototype.removeOverlay=function(m){if(m.remove){m.remove()}if(m.setMap){m.setMap(null)}};j.prototype.getBounds=function(){var m=this.map.getBounds();return c.convertBounds(m)};j.prototype.displayCoordinates=function(m){if(this.latLngOverlay==undefined){var o=function(q){var r=document.createElement("DIV");r.innerHTML="Position: ";r.className="ei-latLngOverlay";q.controls[h.ControlPosition.BOTTOM_LEFT].push(r);var p=q.getDiv();b.addDomListener(p,"mousemove",function(t){var s=q.convertScreenPositionToLatLng(t.clientX,t.clientY);r.innerHTML="Position: long "+s.lng().toFixed(4)+" deg, lat "+s.lat().toFixed(4)+" deg"});this.div_=r};o.prototype.show=function(){this.div_.style.display="block"};o.prototype.hide=function(){this.div_.style.display="none"};this.latLngOverlay=new o(this.map)}if(m){this.latLngOverlay.show()}else{this.latLngOverlay.hide()}};j.prototype.displayCoordinatesGrid=function(m){if(!this.graticule){this.graticule=new d(this.map);this.graticule.draw()}if(m){this.graticule.show()}else{this.graticule.hide()}};return j})();c.createMarker=function(l,k,j){return new h.Marker({map:l,position:k,icon:new h.MarkerImage(j.url,undefined,new h.Point(0,0),new h.Point(j.shiftX,j.shiftY)),flat:true})};c.uniMarker=function(j,o,k,l,n,m){this.map2D=j;this.marker=c.createMarker(j.map,new h.LatLng(o,k),{url:l,shiftX:n,shiftY:m});j.overlaysArray.push(this)};c.uniMarker.prototype.setTitle=function(j){this.marker.setTitle(j)};c.uniMarker.prototype.setListener=function(k,l){var j=this;c.setListener(this.marker,k,function(){l(j)})};c.uniMarker.prototype.setDraggable=function(k){this.marker.setDraggable(true);var j=this;c.setListener(this.marker,"dragend",function(){k(j)})};c.uniMarker.prototype.setClickHandler=function(k){var j=this;c.setListener(this.marker,"click",function(l){k(l.latLng.lat(),l.latLng.lng())})};c.uniMarker.prototype.setDblClickHandler=function(k){var j=this;c.setListener(this.marker,"dblclick",function(){k(j)})};c.uniMarker.prototype.setOnDragHandler=function(k){this.marker.setDraggable(true);var j=this;c.setListener(this.marker,"drag",function(){k(j)})};c.uniMarker.prototype.setVisible=function(j){return this.marker.setVisible(j)};c.uniMarker.prototype.getPosition=function(){return this.marker.getPosition()};c.uniMarker.prototype.getLat=function(){return this.marker.getPosition().lat()};c.uniMarker.prototype.getLng=function(){return this.marker.getPosition().lng()};c.uniMarker.prototype.setTitle=function(j){return this.marker.setTitle(j)};c.uniMarker.prototype.setPosition=function(k,j){return this.marker.setPosition(new h.LatLng(k,j))};c.uniMarker.prototype.remove=function(){this.marker.setMap(null)};c.uniMarker.prototype.halfWayTo=function(j,k){return c.halfWayTo(this.getPosition(),j.getPosition(),k)};c.createPoint=function(k,o){if(k.editCleanUp){k.editCleanUp()}var n=k.map;var l=g(n);n.setOptions({draggableCursor:"crosshair"});b.addListener(l,"click",j);b.addListener(l,"mousemove",function(p){k.theTooltip.show(p.latLng,"<p>Click to create point at ("+p.latLng.toUrlValue(4)+")</p>")});function j(p){m();o(p.latLng.lat(),p.latLng.lng())}function m(){b.clearInstanceListeners(l);l.setMap(null);delete l;n.setOptions({draggableCursor:"auto"});k.theTooltip.hide();k.editCleanUp=null}k.editCleanUp=m};c.uniSurface=function(j){this.map2D=j;this.surface=[]};c.uniSurface.prototype.setClickHandler=function(j){c.setListener(this.surface,"click",function(k){j(k.latLng.lat(),k.latLng.lng())})};c.uniSurface.prototype.setMouseOverHandler=function(k){var j=this;c.setListener(this.surface,"mouseover",function(m){var l=j.map2D.getProjection().fromLatLngToContainerPixel(m.latLng);k(l.x,l.y)})};c.uniSurface.prototype.setMouseOutHandler=function(k){var j=this;c.setListener(this.surface,"mouseout",function(){k(j)})};c.uniSurface.prototype.setTooltip=function(k){var j=this;c.setListener(this.surface,"mousemove",function(l){j.map2D.theTooltip.show(l.latLng,k)});c.setListener(this.surface,"mouseout",function(){j.map2D.theTooltip.hide();j.surface.setOptions({strokeWeight:j.weight})});c.setListener(this.surface,"mouseover",function(){j.surface.setOptions({strokeWeight:j.weight*2})})};c.uniSurface.prototype.setVisible=function(j){this.surface.setVisible(j);this.setEditMode(false)};c.uniSurface.prototype.setFillColor=function(j){this.surface.setOptions({fillColor:j})};c.uniSurface.prototype.setFillOpacity=function(j){this.fillopacity=j;this.surface.setOptions({fillOpacity:j})};c.uniSurface.prototype.setStrokeStyle=function(j,k,l){this.color=j;this.opacity=k;this.weight=l;this.surface.setOptions({strokeColor:j,strokeWeight:l,strokeOpacity:k})};c.uniSurface.prototype.setHighlighted=function(j){if(j&&!this.isHighlighted){this.surface.setOptions({strokeColor:"#ffffff",strokeWeight:this.weight*2});this.isHighlighted=true;this.setOnTop()}else{if(!j&&this.isHighlighted){this.surface.setOptions({strokeColor:this.color,strokeWeight:this.weight});this.isHighlighted=false}}};c.uniSurface.prototype.setOnTop=function(){this.surface.setOptions({zIndex:this.map2D.zIndex++})};c.uniSurface.prototype.sendToBack=function(){this.surface.setOptions({zIndex:0})};c.uniSurface.prototype.configureEditable=function(k){var j=this;this.edit=undefined;this.editable=true;this.setEditMode(false);c.setListener(this.surface,"mouseover",function(){if(j.edit!=true&&j.editable==true){j.setHighlighted(true)}else{j.setHighlighted(false)}});c.setListener(this.surface,"mousemove",function(l){if(j.edit!=true&&j.editable==true){j.map2D.theTooltip.show(l.latLng,"<p>"+k+"</p>")}});c.setListener(this.surface,"mouseout",function(){j.setHighlighted(false);j.map2D.theTooltip.hide()});c.setListener(this.surface,"click",function(){if(j.editable==true){j.map2D.disableAllEditMode();j.setHighlighted(false);j.setEditMode(true);b.addListener(j.map2D.map,"click",function(l){j.setEditMode(false)});j.map2D.theTooltip.hide()}})};c.uniSurface.prototype.setEditable=function(j){this.editable=j;this.setEditMode(j)};c.uniSurface.prototype.isEditable=function(){return this.editable};c.uniSurface.prototype.setCenter=function(k,j){return this._setCenter(new h.LatLng(k,j))};c.uniSurface.prototype.getZIndex=function(){return this.surface.get("zIndex")};c.uniSurface.prototype.getCenter=function(){var j=this._getCenter();return[j.lat(),j.lng()]};c.uniSurface.prototype.setContextMenu=function(j){c.setListener(this.surface,"rightclick",function(k){j(k.latLng.lat(),k.latLng.lng())})};c.createPolypoints=function(m,k,n,l,w){if(m.editCleanUp){m.editCleanUp()}m.disableAllEditMode();var z=m.map;var o;var y;if(k.polygon){o=new h.Polygon({map:z,strokeColor:k.color,strokeWeight:k.thickness,strokeOpacity:k.opacity,fillColor:k.fillcolor,fillOpacity:k.fillopacity,geodesic:k.geodesic});y=3}else{o=new h.Polyline({map:z,strokeColor:k.color,strokeWeight:k.thickness,strokeOpacity:k.opacity,geodesic:k.geodesic});y=2}o.setMap(z);var s=o.getPath();var u=g(z);var j=k.dragMarkerIcon?k.dragMarkerIcon:c.defaultDragMarker;var v=new h.MarkerImage(j.url,undefined,undefined,new h.Point(j.shiftX,j.shiftY));var t=[];var A=null;function x(C){var B=new h.Marker({animation:false,flat:true,icon:v,raiseOnDrag:false,position:C,map:z});t.push(B);b.addListenerOnce(B,"click",p)}function r(B){B.stop();clearTimeout(A);if(s.getAt(s.getLength()-2).equals(s.getAt(s.getLength()-1))){s.pop()}if(s.getLength()>=y){n(c.convertPath(s));q()}}function q(){o.setMap(null);var B;for(B=0;B<t.length;B++){t[B].setMap(null)}m.theTooltip.hide();b.clearInstanceListeners(u);u.setMap(null);delete u;m.editCleanUp=null;t=[];u=null}m.editCleanUp=q;var p=function(C){var B=C.latLng;if(s.getLength()==0){s.push(B);x(B);s.push(B)}else{s.push(B);A=setTimeout(function(){x(B)},300)}if(s.getLength()==y){b.addListenerOnce(u,"dblclick",r)}};b.addListener(u,"click",p);b.addListener(u,"mousemove",function(B){if(s.getLength()==0){m.theTooltip.show(B.latLng,"<p>Click to add first point</p>")}else{s.setAt(s.length-1,B.latLng);if(s.getLength()<y){m.theTooltip.show(B.latLng,"<p>Click to add one point</p>")}else{m.theTooltip.show(B.latLng,"<p>Double click to finish this shape</p>")}}});if(l!=undefined&&w!=undefined){p({latLng:new h.LatLng(l,w)})}};c.createPolygon=function(l,n,s,q,m,p,r,o,t,j,k){c.createPolypoints(l,{polygon:true,color:n,thickness:s,opacity:q,fillcolor:m,fillopacity:p,clickable:r,geodesic:o},t,j,k)};c.uniPolygon=function(j,l,k){this.map2D=j;if(l==undefined||l.length==undefined||l.length<6){return}this.color=k.color||"#ffffff";this.weight=k.thickness||2;this.opacity=k.opacity==undefined?1:k.opacity;this.fillopacity=k.fillOpacity==undefined?0.7:k.fillOpacity;this.geodesic=k.geodesic==undefined?true:k.geodesic;this.surface=new h.Polygon({map:this.map2D.map,path:c.generatePath(l),strokeColor:this.color,strokeWeight:this.weight,strokeOpacity:this.opacity,fillColor:k.fillColor||"#888888",fillOpacity:this.fillopacity,clickable:true,geodesic:this.geodesic,zIndex:this.map2D.zIndex++});this.isHighlighted=false;this.path=this.surface.getPath();this.closed=true;this.minPoints=3;this.map2D.overlaysArray.push(this);if(typeof k.callback=="function"){this.editCallback=k.callback;this.markers=[];this.editmarkers=[];if(k.constraint){this.constraintPath=new h.Polygon({path:c.generatePath(k.constraint)})}this.configureEditable("Click to graphically edit the points of this polygon")}else{this.editable=false}};c.uniPolygon.prototype=new c.uniSurface();c.uniPolygon.prototype.getArea=function(){return h.geometry.spherical.computeArea(this.path)};c.uniPolygon.prototype.addPoint=function(k,j){var l=this.path;var m=j?j:l.length;l.insertAt(m,k);this.addMarkerPoint(m,k)};c.uniPolygon.prototype.addMarkerPoint=function(n,k){var l=this.path;var m=this;var j=c.createMarker(this.map2D.map,new h.LatLng(k.lat(),k.lng()),this.dragMarker?this.dragMarker:c.defaultDragMarker);j.setDraggable(true);c.setListener(j,"drag",function(q){for(var p=0,o=m.markers.length;p<o&&m.markers[p]!=j;++p){}if(!m.constraintPath||(m.constraintPath&&h.geometry.poly.containsLocation(j.getPosition(),m.constraintPath))){l.setAt(p,j.getPosition());m.updateEditMarkers(false)}else{j.setPosition(l.getAt(p))}});c.setListener(j,"dragend",function(q){if(m.constraintPath&&!h.geometry.poly.containsLocation(j.getPosition(),m.constraintPath)){for(var p=0,o=m.markers.length;p<o&&m.markers[p]!=j;++p){}j.setPosition(l.getAt(p))}m.editCallback(m.getPositions())});j.setTitle("Double click to remove this point");c.setListener(j,"dblclick",function(){m.removePoint(j)});this.markers.splice(n,0,j)};c.uniPolygon.prototype.removePoint=function(j){var m=this.path;if(m.length>this.minPoints){for(var l=0,k=this.markers.length;l<k&&this.markers[l]!=j;++l){}this.markers[l].setMap(null);this.markers.splice(l,1);m.removeAt(l);if(this.editCallback){this.updateEditMarkers(true);this.editCallback(this.getPositions())}}};c.uniPolygon.prototype.setEditMode=function(j){this.edit=j;if(this.editable){if(j&&this.markers.length==0){this.createEditMarkers();this.createPointMarkers()}this.setMarkersVisibility(j)}};c.uniPolygon.prototype.createPointMarkers=function(){if(this.markers){var k;for(k=0;k<this.markers.length;k++){this.markers[k].setMap(null)}}var j=this;this.path.forEach(function(m,l){j.addMarkerPoint(l,m)})};c.uniPolygon.prototype.createEditMarkers=function(){if(this.editmarkers){var j;for(j=0;j<this.editmarkers.length;j++){this.editmarkers[j].setMap(null)}}this.editmarkers=[];var n=this;var l;var k=this.closed?this.path.getLength():this.path.getLength()-1;for(j=0;j<k;j++){l=c.halfWayTo(this.path.getAt(j),this.path.getAt(j+1<this.path.getLength()?j+1:0),this.geodesic);var m=c.createMarker(this.map2D.map,new h.LatLng(l.lat(),l.lng()),this.editMarker?this.editMarker:c.defaultEditMarker);m.setDraggable(true);(function(o){c.setListener(o,"dragstart",function(){n.path.insertAt(o.markerPos,o.getPosition())});c.setListener(o,"drag",function(){if(!n.constraintPath||(n.constraintPath&&h.geometry.poly.containsLocation(o.getPosition(),n.constraintPath))){n.path.setAt(o.markerPos,o.getPosition())}else{o.setPosition(n.path.getAt(o.markerPos))}});c.setListener(o,"dragend",function(){if(n.constraintPath&&!h.geometry.poly.containsLocation(o.getPosition(),n.constraintPath)){o.setPosition(n.path.getAt(o.markerPos))}n.path.removeAt(o.markerPos);n.addPoint(o.getPosition(),o.markerPos);n.updateEditMarkers(true);n.editCallback(n.getPositions())})})(m);m.setTitle("Drag me to create a new point!");m.markerPos=j+1;this.editmarkers.push(m)}};c.uniPolygon.prototype.updateMarkers=function(k){var j;for(j=0;j<this.markers.length;j++){this.markers[j].setPosition(this.path.getAt(j))}this.updateEditMarkers(k)};c.uniPolygon.prototype.updateEditMarkers=function(k){if(k==true){this.createEditMarkers()}else{var l,j;for(j=0;j<this.editmarkers.length;j++){l=c.halfWayTo(this.markers[j].getPosition(),this.markers[j+1<this.markers.length?j+1:0].getPosition(),this.geodesic);this.editmarkers[j].setPosition(l)}}};c.uniPolygon.prototype.setMarkersVisibility=function(k){var j;for(j=0;j<this.markers.length;j++){this.markers[j].setVisible(k)}for(j=0;j<this.editmarkers.length;j++){this.editmarkers[j].setVisible(k)}};c.uniPolygon.prototype.getPositions=function(){return c.convertPath(this.path)};c.uniPolygon.prototype.forceSouthPole=function(){var k=this.surface.getPath().getArray();var j=[new h.LatLng(-89.99,180),new h.LatLng(-89.99,-120),new h.LatLng(-89.99,-60),new h.LatLng(-89.99,0),new h.LatLng(-89.99,60),new h.LatLng(-89.99,120),new h.LatLng(-89.99,180)];this.surface.setPaths([k,j])};c.uniPolygon.prototype.updatePositions=function(j){this.path.clear();if(this.edit==true){var k;for(k=0;k<this.markers.length;k++){this.markers[k].setMap(null)}this.markers=[];for(k=0;k<j.length;){this.addPoint(new h.LatLng(j[k],j[k+1]));k=k+2}this.updateEditMarkers(true)}else{for(k=0;k<j.length;){this.path.push(new h.LatLng(j[k],j[k+1]));k=k+2}}};c.uniPolygon.prototype.getEOBounds=function(){var j=c._getPathBounds(this.surface.getPath());return c.convertBounds(j)};c.uniPolygon.prototype._getCenter=function(){return c._getPathCenter(this.surface.getPath())};c.uniPolygon.prototype._setCenter=function(l){var j=this._getCenter();var k=l.lat()-j.lat();var o=l.lng()-j.lng();var m;for(m=0;m<this.path.getLength();m++){if(Math.abs(this.path.getAt(m).lat()+k)>90){return false}}var n;for(m=0;m<this.path.getLength();m++){n=this.path.getAt(m);this.path.setAt(m,new h.LatLng(n.lat()+k,n.lng()+o))}if(this.editable){this.updateMarkers(false)}return true};c.uniPolygon.prototype.remove=function(){this.surface.setMap(null);if(this.markers){for(var k=0,j=this.markers.length;k<j;k++){this.markers[k].setMap(null)}}if(this.editmarkers){for(k=0,j=this.editmarkers.length;k<j;k++){this.editmarkers[k].setMap(null)}}};c.createCircle=function(m,o,w,u,n,r,v,q,x,k,l){if(m.editCleanUp){m.editCleanUp()}var j=m.map;var p=g(j);j.setOptions({draggableCursor:"crosshair"});b.addListener(p,"click",s);b.addListener(p,"mousemove",function(y){m.theTooltip.show(y.latLng,"<p>Click to create center for circle</p>")});function s(A){b.clearInstanceListeners(p);var y=A.latLng;var G=new h.MarkerImage("./img/dragIcon.png",undefined,undefined,new h.Point(5,5));var D=new h.Marker({animation:false,flat:true,icon:G,raiseOnDrag:false,position:A.latLng,map:j});var z=new h.Circle({map:j,center:y,radius:1,strokeColor:o,strokeWeight:w,strokeOpacity:u,fillColor:n,fillOpacity:r,geodesic:q});var H=new h.Polyline({map:j,path:[y,y],strokeColor:o,strokeWeight:w,strokeOpacity:0,geodesic:true});function I(K){var J=h.geometry.spherical.computeDistanceBetween(y,K.latLng);z.setRadius(J);H.getPath().setAt(1,K.latLng);H.setOptions({strokeOpacity:1});m.theTooltip.show(c.halfWayTo(K.latLng,y),"<p>Radius is: "+c.roundDistance(J)+"</p><p>Click to finalise</p>")}function B(K){var J=h.geometry.spherical.computeDistanceBetween(y,K.latLng);C();x(y.lat(),y.lng(),J)}var E=b.addListener(p,"mousemove",I);var F=b.addListener(p,"click",B);function C(){b.clearInstanceListeners(p);p.setMap(null);delete p;j.setOptions({draggableCursor:"auto"});z.setMap(null);H.setMap(null);D.setMap(null);m.theTooltip.hide();m.editCleanUp=null}m.editCleanUp=C}function t(){j.setOptions({draggableCursor:"auto"});b.clearInstanceListeners(p);p.setMap(null);delete p;m.editCleanUp=null}m.editCleanUp=t;if(k!=undefined&&l!=undefined){s({latLng:new h.LatLng(k,l)})}};c.uniCircle=function(m,k,l,o,r){this.map2D=m;var j=new h.LatLng(k,l);this.color=r.color||"#ffffff";this.weight=r.thickness||2;this.opacity=r.opacity==undefined?1:r.opacity;this.fillopacity=r.fillOpacity==undefined?0.7:r.fillOpacity;this.surface=new h.Circle({map:m.map,center:j,radius:o,strokeColor:this.color,strokeWeight:this.weight,strokeOpacity:this.opacity,fillColor:r.fillColor||"#888888",fillOpacity:this.fillopacity,clickable:r.clickable});this.isHighlighted=false;this.editable=false;this.callback=r.callback;if(this.callback!=null&&typeof this.callback=="function"){var n=h.geometry.spherical.computeOffset(j,o,90);if(r.constraint){this.constraintPath=new h.Polygon({path:c.generatePath(r.constraint)})}var q=c.createMarker(m.map,new h.LatLng(n.lat(),n.lng()),c.defaultDragMarker);q.setDraggable(true);var p=this;c.setListener(q,"dragend",function(){p.refreshCircle(false);p.callback(p.center.lat(),p.center.lng(),p.getRadius())});c.setListener(q,"drag",function(){if(!p.constraintPath||(p.constraintPath&&h.geometry.poly.containsLocation(q.getPosition(),p.constraintPath))){}p.refreshCircle(true)});this.polyline=new h.Polyline({map:m.map,path:[j,n],strokeColor:this.color,strokeWeight:this.weight,strokeOpacity:0,geodesic:true});this.center=j;this.radius=o;this.radiusMarker=q;this.configureEditable("Click to graphically edit the center and radius of this circle")}m.overlaysArray.push(this)};c.uniCircle.prototype=new c.uniSurface();c.uniCircle.prototype.setEditMode=function(k){this.edit=k;if(this.radiusMarker){if(k){var j=h.geometry.spherical.computeOffset(this.center,this.radius,90);this.radiusMarker.setPosition(j);this.polyline.setPath([this.center,j])}this.radiusMarker.setVisible(k)}};c.uniCircle.prototype.refreshCircle=function(k){var j=this.getRadius();this.radius=j;this.surface.setRadius(j);if(k==true){this.polyline.getPath().setAt(1,this.radiusMarker.getPosition());this.polyline.setOptions({strokeOpacity:1});this.map2D.theTooltip.show(c.halfWayTo(this.radiusMarker.getPosition(),this.center),"<p>Radius is: "+c.roundDistance(j)+"</p>")}else{this.polyline.setOptions({strokeOpacity:0});this.map2D.theTooltip.hide()}};c.uniCircle.prototype.getRadius=function(){return h.geometry.spherical.computeDistanceBetween(this.radiusMarker.getPosition(),this.center)};c.uniCircle.prototype.getEOBounds=function(){var j=this.surface.getBounds();return c.convertBounds(j)};c.uniCircle.prototype.getArea=function(){return 0};c.uniCircle.prototype._getCenter=function(){return this.surface.getCenter()};c.uniCircle.prototype._setCenter=function(j){this.surface.setCenter(j);this.center=j;this.setEditMode(false);return true};c.uniCircle.prototype.setRadius=function(j){this.surface.setRadius(j);this.radius=j;this.setEditMode(false);return true};c.uniCircle.prototype.remove=function(){this.surface.setMap(null);if(this.polyline){this.polyline.setMap(null);this.radiusMarker.setMap(null)}this.map2D.theTooltip.hide()};c.createRectangle=function(n,p,w,u,o,s,v,r,x,l,m){if(n.editCleanUp){n.editCleanUp()}var j=n.map;j.setOptions({draggableCursor:"crosshair"});var q=g(j);function k(z){b.clearInstanceListeners(q);var H=z.latLng;var G=new h.Polygon({map:j,strokeColor:p,strokeWeight:w,strokeOpacity:u,fillColor:o,fillOpacity:s});var J=new h.MVCArray;G.setPaths(new h.MVCArray([J]));var E=new c.uniMarker(n,H.lat(),H.lng(),"./img/dragIcon.png",5,5);var D=new c.uniMarker(n,H.lat(),H.lng(),"./img/dragIcon.png",5,5);var I=new c.uniMarker(n,H.lat(),H.lng(),"./img/dragIcon.png",5,5);var B=new c.uniMarker(n,H.lat(),H.lng(),"./img/dragIcon.png",5,5);y(H,H);function y(L,K){c.uniRectangle.refreshPath(J,L,K);E.setPosition(L.lat(),L.lng());D.setPosition(K.lat(),K.lng());I.setPosition(L.lat(),K.lng());B.setPosition(K.lat(),L.lng())}function F(M){var L=M.latLng;var K=H;var N=Math.abs(L.lng()-K.lng());if(N<180){y(L,K);n.theTooltip.show(M.latLng,"<p>Position: "+M.latLng.toUrlValue(4)+"</p><p>Click to complete</p>")}else{A()}}function A(L){var K=new google.maps.LatLngBounds();K.extend(E.getPosition());K.extend(D.getPosition());x(K.getNorthEast().lat(),K.getSouthWest().lng(),K.getSouthWest().lat(),K.getNorthEast().lng());C()}function C(){E.remove();D.remove();I.remove();B.remove();j.setOptions({draggableCursor:"auto"});G.setMap(null);b.clearInstanceListeners(q);q.setMap(null);delete q;n.theTooltip.hide();n.editCleanUp=null}n.editCleanUp=C;b.addListener(q,"mousemove",F);b.addListener(q,"click",A);D.setListener("click",A);I.setListener("click",A);B.setListener("click",A);E.setListener("click",A)}b.addListener(q,"click",k);b.addListener(q,"mousemove",function(y){n.theTooltip.show(y.latLng,"<p>Click to create the Rectangle</p>")});function t(){b.clearInstanceListeners(q);q.setMap(null);delete q;j.setOptions({draggableCursor:"auto"});n.editCleanUp=null}n.editCleanUp=t;if(l!=undefined&&m!=undefined){k({latLng:new h.LatLng(l,m)})}};c.createZoomRectangle=function(n,p,u,t,o,r,v,l,m){if(n.editCleanUp){n.editCleanUp()}var j=n.map;var q=g(j);function k(A){b.clearInstanceListeners(q);var w=A.latLng;var y=new h.Polygon({map:j,strokeColor:p,strokeWeight:u,strokeOpacity:t,fillColor:o,fillOpacity:r});var D=new h.MVCArray;y.setPaths(new h.MVCArray([D]));C(w,w);function C(F,E){c.uniRectangle.refreshPath(D,F,E)}function z(G){var F=G.latLng;var E=w;C(F,E);n.theTooltip.show(G.latLng,"<p>Position: "+G.latLng.toUrlValue(4)+"</p><p>Click to zoom to extent</p>")}function x(G){var F=D.getAt(1);var E=D.getAt(3);v(F.lat(),F.lng(),E.lat(),E.lng());B()}function B(){y.setMap(null);b.clearInstanceListeners(q);q.setMap(null);delete q;n.theTooltip.hide();n.editCleanUp=null}n.editCleanUp=B;b.addListener(q,"mousemove",z);b.addListener(q,"click",x)}b.addListener(q,"click",k);b.addListener(q,"mousemove",function(w){n.theTooltip.show(w.latLng,"<p>Click to start defining zoom area</p>")});function s(){b.clearInstanceListeners(q);q.setMap(null);delete q;j.setOptions({draggableCursor:"auto"});n.editCleanUp=null}n.editCleanUp=s;if(l!=undefined&&m!=undefined){k({latLng:new h.LatLng(l,m)})}};c.uniRectangle=function(m,r,s,o,q,x){this.map2D=m;var j=new h.LatLngBounds(new h.LatLng(o,s),new h.LatLng(r,q));this.color=x.color||"#ffffff";this.weight=x.thickness||2;this.opacity=x.opacity==undefined?1:x.opacity;this.fillopacity=x.fillOpacity==undefined?0.7:x.fillOpacity;this.surface=new h.Polygon({map:m.map,path:[],strokeColor:this.color,strokeWeight:this.weight,strokeOpacity:this.opacity,fillColor:x.fillColor||"#888888",fillOpacity:this.fillopacity,clickable:true});this.isHighlighted=false;this.editable=false;this.path=this.surface.getPath();if(x.callback!=null&&typeof x.callback=="function"){this.callback=x.callback;var t=this;function v(){var y=new google.maps.LatLngBounds();y.extend(p.getPosition());y.extend(n.getPosition());t.callback(y.getNorthEast().lat(),y.getSouthWest().lng(),y.getSouthWest().lat(),y.getNorthEast().lng());m.theTooltip.hide()}function l(z,A){if(A){k.setPosition(new h.LatLng(n.getPosition().lat(),p.getPosition().lng()));w.setPosition(new h.LatLng(p.getPosition().lat(),n.getPosition().lng()))}else{p.setPosition(new h.LatLng(w.getPosition().lat(),k.getPosition().lng()));n.setPosition(new h.LatLng(k.getPosition().lat(),w.getPosition().lng()))}t.refreshRectangle();var y=z.getPosition();m.theTooltip.show(y,"<p>Position: "+y.toUrlValue(4)+"</p>")}function u(A,z){var y=c.createMarker(m.map,A,c.defaultDragMarker);y.setDraggable(true);c.setListener(y,"dragend",v);c.setListener(y,"drag",function(){l(y,z)});return y}var p=u(new h.LatLng(j.getNorthEast().lat(),j.getSouthWest().lng()),true);var n=u(new h.LatLng(j.getSouthWest().lat(),j.getNorthEast().lng()),true);var w=u(j.getNorthEast(),false);var k=u(j.getSouthWest(),false);this.topLeftMarker=p;this.bottomRightMarker=n;this.topRightMarker=w;this.bottomLeftMarker=k;this.configureEditable("Click to graphically edit the corners of this Rectangle");this.refreshRectangle()}else{c.uniRectangle.refreshPath(this.path,new h.LatLng(r,s),new h.LatLng(o,q))}m.overlaysArray.push(this)};c.uniRectangle.prototype=new c.uniSurface();c.uniRectangle.refreshPath=function(n,m,k){n.setAt(0,m);var l=new h.LatLng(m.lat(),k.lng());n.setAt(1,l);n.setAt(2,k);var j=new h.LatLng(k.lat(),m.lng());n.setAt(3,j)};c.uniRectangle.prototype.refreshRectangle=function(){var k=this.topLeftMarker.getPosition();var j=this.bottomRightMarker.getPosition();this.topRightMarker.setPosition(new h.LatLng(k.lat(),j.lng()));this.bottomLeftMarker.setPosition(new h.LatLng(j.lat(),k.lng()));c.uniRectangle.refreshPath(this.surface.getPath(),this.topLeftMarker.getPosition(),this.bottomRightMarker.getPosition())};c.uniRectangle.prototype.refreshMarkers=function(){var l=c._getPathBounds(this.surface.getPath());var j=l.getNorthEast();var k=l.getSouthWest();this.topLeftMarker.setPosition(new h.LatLng(j.lat(),k.lng()));this.topRightMarker.setPosition(j);this.bottomRightMarker.setPosition(new h.LatLng(k.lat(),j.lng()));this.bottomLeftMarker.setPosition(k)};c.uniRectangle.prototype._getBounds=function(){return c._getPathBounds(this.surface.getPath())};c.uniRectangle.prototype.getEOBounds=function(){return c.convertBounds(this._getBounds())};c.uniRectangle.prototype.setBounds=function(m,k,l,j){c.uniRectangle.refreshPath(this.surface.getPath(),new h.LatLng(l,j),new h.LatLng(m,k));if(this.editable){this.refreshMarkers()}};c.uniRectangle.prototype.getArea=function(){return h.geometry.spherical.computeArea(this.surface.getPath())};c.uniRectangle.prototype._getCenter=function(){return this._getBounds().getCenter()};c.uniRectangle.prototype._setCenter=function(l){var j=this._getCenter();var k=l.lat()-j.lat();var o=l.lng()-j.lng();var n=this.topLeftMarker.getPosition();var m=this.bottomRightMarker.getPosition();if(Math.abs(n.lat()+k)>=90||Math.abs(m.lat()+k)>=90){return false}this.topLeftMarker.setPosition(new h.LatLng(n.lat()+k,n.lng()+o));this.bottomRightMarker.setPosition(new h.LatLng(m.lat()+k,m.lng()+o));this.refreshRectangle();return true};c.uniRectangle.prototype.setEditMode=function(j){this.edit=j;if(this.topLeftMarker){this.topLeftMarker.setVisible(j);this.bottomRightMarker.setVisible(j);this.topRightMarker.setVisible(j);this.bottomLeftMarker.setVisible(j)}};c.uniRectangle.prototype.remove=function(){this.surface.setMap(null);if(this.topLeftMarker){this.topLeftMarker.setMap(null);this.bottomRightMarker.setMap(null);this.bottomLeftMarker.setMap(null);this.topRightMarker.setMap(null)}this.map2D.theTooltip.hide()};c.createPolyline=function(l,m,r,o,p,n,s,j,k,q){c.createPolypoints(l,{polygon:false,color:m,thickness:r,opacity:o,clickable:p,geodesic:n,dragMarkerIcon:q},s,j,k)};c.uniPolyline=function(k,s,m,t,p,q,n,o,l,r,j){this.map2D=k;this.markers=[];this.editmarkers=[];this.editCallback=o;this.editMarkerCallback=l;this.surface=new h.Polyline({map:k.map,path:c.generatePath(s),strokeColor:m,strokeWeight:t,strokeOpacity:p,clickable:true,geodesic:n});this.color=m;this.weight=t;this.opacity=p;this.geodesic=n;this.isHighlighted=false;this.path=this.surface.getPath();this.editable=false;this.dragMarker=r;this.editMarker=j;k.overlaysArray.push(this);this.minPoints=2;if(typeof o=="function"){this.editCallback=o;this.editMarkerCallback=l;this.markers=[];this.editmarkers=[];this.configureEditable("Click to graphically edit the points of this line")}else{this.editable=false}};c.uniPolyline.prototype=new c.uniPolygon();c.uniPolyline.prototype.getLength=function(){return h.geometry.spherical.computeLength(this.surface.getPath())};c.uniRuler=function(j,p,k,m,l,o,n,q){this.map2D=j;this.markers=[];this.editmarkers=[];this.editCallback=o;this.surface=new h.Polyline({map:j.map,path:c.generatePath(p),strokeColor:k,strokeWeight:m,strokeOpacity:l,clickable:true,geodesic:true});this.color=k;this.weight=m;this.opacity=l;this.geodesic=true;this.isHighlighted=false;this.path=this.surface.getPath();this.editable=true;this.dragMarker=n;this.editMarker=q;j.overlaysArray.push(this);this.minPoints=2;this.configureEditable("Click on the grey circles to add a point to the ruler's path  or drag the markers");this.setEditMode(true)};c.uniRuler.prototype=new c.uniPolygon();c.uniRuler.prototype.configureEditable=function(k){var j=this;this.edit=undefined;this.editable=true;c.setListener(this.surface,"mousemove",function(l){j.map2D.theTooltip.show(l.latLng,"<p>"+k+"</p>")});c.setListener(this.surface,"mouseout",function(){j.map2D.theTooltip.hide()})};c.uniRuler.prototype.setMarkersVisibility=function(k){var j;for(j=0;j<this.markers.length;j++){this.markers[j].setVisible(true)}for(j=0;j<this.editmarkers.length;j++){this.editmarkers[j].setVisible(true)}};c.constrainedFrame=function(m,t,C,u){var H=m.map;var l=c.generatePath(t);var A=h.geometry.spherical;var p=l.getAt(0);var G=l.getAt(1);var o=l.getAt(3);var F=l.getAt(2);var r=A.computeDistanceBetween(p,G);var k=A.computeHeading(p,G);var j=A.computeHeading(o,F);var x=A.computeDistanceBetween(p,new h.LatLng(frameCoords[0],frameCoords[1]))/r;var E=Math.round(A.computeDistanceBetween(new h.LatLng(frameCoords[0],frameCoords[1]),new h.LatLng(frameCoords[2],frameCoords[3]))/frameLength);var v=new h.MVCArray([A.interpolate(p,G,x),A.interpolate(p,G,x+(E*frameLength)/r),A.interpolate(o,F,x+(E*frameLength)/r),A.interpolate(o,F,x)]);v.setAt(4,v.getAt(0));var z=new h.Polygon({paths:v,strokeColor:editable?"#00FF00":"#fff",strokeOpacity:0.8,strokeWeight:editable?2:1,fillColor:"#eef",fillOpacity:editable?0:0.35,geodesic:true});z.setMap(H);this.surface=z;var s=A.computeDistanceBetween(v.getAt(0),v.getAt(1));var q=A.computeDistanceBetween(v.getAt(3),v.getAt(2));var n=[];var B=1/E;function w(){for(var K=0;K<E+1;K++){var J=A.interpolate(v.getAt(0),v.getAt(1),K*B);var L=A.interpolate(v.getAt(3),v.getAt(2),K*B);if(!n[K]){n[K]=new h.Polyline({map:H,strokeColor:"#fff",strokeWeight:1,strokeOpacity:K==0||K==E?0:0.5,geodesic:true})}n[K].setPath([J,L])}}w();if(editable){function y(){H.setOptions({draggable:true})}function D(K,J){var N=J.lat()-K.lat();var P=J.lng()-K.lng();var O=A.computeHeading(K,J);var M=A.computeDistanceBetween(K,J)*Math.cos(Math.PI*(O-k)/180);var L=(A.computeDistanceBetween(p,v.getAt(0))+M)/r;var Q=(A.computeDistanceBetween(p,v.getAt(0))+M+s)/r;if(L>0&&L<1&&Q>0&&Q<1){v.setAt(0,A.interpolate(p,G,L));v.setAt(3,A.interpolate(o,F,L));v.setAt(4,v.getAt(0));v.setAt(1,A.interpolate(p,G,Q));v.setAt(2,A.interpolate(o,F,Q))}w()}var I=null}this.polygon=z;this.polylines=n;this.insidePath=v};c.constrainedFrame.prototype=new c.uniPolygon();function e(k,j){return((k%j)+j)%j}c.uniTMSLayer=(function(){function j(m,l,r,o,s,t,u,v,q){var n=m.map;var k=null;if(s&&u){k=new h.LatLngBounds(new h.LatLng(s,t),new h.LatLng(u,v))}var p=new h.ImageMapType({getTileUrl:function(C,y){var x=n.getProjection();var A=Math.pow(2,y);var w=x.fromPointToLatLng(new h.Point(C.x*256/A,(C.y+1)*256/A));var z=x.fromPointToLatLng(new h.Point((C.x+1)*256/A,C.y*256/A));if(k){var B=new h.LatLngBounds(w,z);if(!B.intersects(k)){return"http://maps.gstatic.com/intl/en_us/mapfiles/transparent.png"}}return l.replace("$z",y).replace("$y",o?C.y:(1<<y)-C.y-1).replace("$x",e(C.x,(1<<y)))},tileSize:new h.Size(256,256),isPng:true});this._map=n;this._layer=p;this._layer.displayCopyright=function(w){m.displayCopyright(r,w)};if(!q){m.overlaysArray.push(this)}}j.prototype.setVisible=function(n){var m=this._map.overlayMapTypes;for(var l=0,k=m.length;l<k&&m.getAt(l)!=this._layer;++l){}if(n){if(l==m.length){m.push(this._layer)}this._layer.displayCopyright(true)}else{if(l<m.length){m.removeAt(l)}this._layer.displayCopyright(false)}};j.prototype.remove=function(){this.setVisible(false)};j.prototype.setOpacity=function(k){if(this._layer){this._layer.setOpacity(k)}};j.prototype.getOpacity=function(){if(this._layer){return this._layer.getOpacity()}else{return 1}};j.prototype.setToBottom=function(){this.setZIndex(0)};j.prototype.setOnTop=function(){this.setZIndex(overlayMaps.length)};j.prototype.setZIndex=function(m){var k=this.getZIndex();if(k==-1){return}var l=this._map.overlayMapTypes;l.removeAt(k);l.insertAt(m,this._layer)};j.prototype.getZIndex=function(){var m=this._map.overlayMapTypes;for(var l=0,k=m.length;l<k&&m.getAt(l)!=this._layer;++l){}return l==m.length?-1:l};return j})();var f={"EPSG:4326":function(j){return{lat:j.lat(),lng:j.lng()}},"EPSG:3857":function(m){if((Math.abs(m.lng())>180||Math.abs(m.lat())>90)){return}var l=m.lng()*0.017453292519943295;var j=6378137*l;var k=m.lat()*0.017453292519943295;return{lng:j,lat:3189068.5*Math.log((1+Math.sin(k))/(1-Math.sin(k)))}}};f["CRS:84"]=f["EPSG:4326"];f["EPSG:102100"]=f["EPSG:3857"];f["EPSG:900913"]=f["EPSG:3857"];c.uniWMSLayer=(function(){function j(p,k,o,s,m,u,F,q,E,z,n,A){var l=p.map;F=F||"EPSG:4326";if(!f[F]){F="EPSG:4326"}var r=new h.LatLngBounds(new h.LatLng(q?q:-90,E?E:-179.99999),new h.LatLng(z?z:90,n?n:179.99999));var B=o.indexOf("1.3")==0;var y=512;var v=k;v+="REQUEST=GetMap";v+="&SERVICE=WMS";v+="&VERSION="+o;v+="&LAYERS="+s;v+="&width="+y;v+="&height="+y;v+="&"+(B==true?"crs":"srs")+"="+F;v+="&TRANSPARENT=TRUE";if(u){v+="&styles="+u}v+="&format=image/png";var w=f[F];var D=B==true&&F=="EPSG:4326";function t(G,H){return G.contains(H.getSouthWest())&&G.contains(H.getNorthEast())}function x(H){this.tileSize=H;this.tiles=[];this.opacity=1;this.mapListener=[];var G=this;this.mapListener.push(google.maps.event.addListener(l,"bounds_changed",function(I){G.updateMarker()}))}x.prototype.activateClipping=function(H){if(H){this.clipBounds=new h.LatLngBounds(r.getSouthWest(),new h.LatLng(r.getNorthEast().lat(),r.getSouthWest().lng()+(r.getNorthEast().lng()-r.getSouthWest().lng())));this.marker=c.createMarker(p.map,this.getMarkerPosition(this.clipBounds.getNorthEast().lng()),{url:"./img/dragClipIcon.png",shiftX:12,shiftY:12});this.marker.setDraggable(true);var G=this;google.maps.event.addListener(this.marker,"drag",function(I){G.markerUpdated(I)});google.maps.event.addListener(this.marker,"dragend",function(I){G.markerUpdated(I)});this.marker.setTitle("Drag to move bounds for overlay")}else{if(this.marker){this.marker.setMap(null);this.marker=null}this.clipBounds=null}this.updateTiles()};x.prototype.markerUpdated=function(L){var H=this.clipBounds;var K=L.latLng;var I=Math.max(Math.min(K.lng(),r.getNorthEast().lng()),r.getSouthWest().lng());var G=new h.LatLng(H.getSouthWest().lat(),H.getSouthWest().lng());var J=new h.LatLng(H.getNorthEast().lat(),I);this.clipBounds=new h.LatLngBounds(G,J);this.updateTiles();this.updateMarker()};x.prototype.getMarkerPosition=function(I){var H=this.clipBounds;var G=l.getBounds();var J;if(!G.intersects(H)||t(G,H)){J=H.getSouthWest().lat()+(H.getNorthEast().lat()-H.getSouthWest().lat())/2}else{if(G.getNorthEast().lat()<H.getNorthEast().lat()&&G.getSouthWest().lat()>H.getSouthWest().lat()){J=G.getSouthWest().lat()+(G.getNorthEast().lat()-G.getSouthWest().lat())/2}else{if(G.getNorthEast().lat()<H.getNorthEast().lat()){J=H.getSouthWest().lat()+(G.getNorthEast().lat()-H.getSouthWest().lat())/2}else{J=G.getSouthWest().lat()+(H.getNorthEast().lat()-G.getSouthWest().lat())/2}}}if(G.intersects(H)&&I>G.getNorthEast().lng()){I=G.getNorthEast().lng()}return new h.LatLng(J,I)};x.prototype.updateMarker=function(){if(this.marker){this.marker.setPosition(this.getMarkerPosition(this.clipBounds.getNorthEast().lng()))}};x.prototype.maxZoom=19;x.prototype.name="Tile #s";x.prototype.alt="Tile Coordinate Map Type";x.prototype.getTile=function(L,R,S){var I=l.getProjection();var O=Math.pow(2,R);var H=1<<(R-1);var K=L.x;if(K<0||K>=H){K=(K%H+H)%H}var J=I.fromPointToLatLng(new h.Point(K*y/O,(L.y+1)*y/O));var Q=I.fromPointToLatLng(new h.Point((K+1)*y/O,L.y*y/O));var P=new h.LatLngBounds(new h.LatLng(Math.min(J.lat(),Q.lat()),Math.min(J.lng(),Q.lng())),new h.LatLng(Math.max(J.lat(),Q.lat()),Math.max(J.lng(),Q.lng())));var N=S.createElement("div");N.style.background="none";N.style.backgroundSize="cover";var G=document.createElement("div");G.style.position="relative";G.style.background="none";G.style.backgroundSize="cover";N.appendChild(G);var M=this;N.updateClip=function(){if(G.border){G.removeChild(G.border);delete G.border}var X=M.clipBounds;if(!X){X=r}var ad=X!=r;var U=y,af=y;if(!P.intersects(X)){url="http://maps.gstatic.com/intl/en_us/mapfiles/transparent.png"}else{var ae=w(new h.LatLng(Math.min(J.lat(),Q.lat()),Math.min(J.lng(),Q.lng())));var aa=w(new h.LatLng(Math.max(J.lat(),Q.lat()),Math.max(J.lng(),Q.lng())));var ac;if(D){ac=ae.lat+","+ae.lng+","+aa.lat+","+aa.lng}else{ac=ae.lng+","+ae.lat+","+aa.lng+","+aa.lat}url=v+"&BBOX="+ac;if(ad){var V=P.getSouthWest().lng()<X.getNorthEast().lng()&&P.getNorthEast().lng()>X.getNorthEast().lng();if(V){U=y*(X.getNorthEast().lng()-P.getSouthWest().lng())/(P.getNorthEast().lng()-P.getSouthWest().lng());var Y=P.getNorthEast().lat()-P.getSouthWest().lat();var W=document.createElement("div");W.style.position="absolute";W.style.width="0px";W.style.background="none";W.style.right="0px";var ab=X.getNorthEast().lat()<P.getNorthEast().lat();var Z=X.getSouthWest().lat()>P.getSouthWest().lat();var T=0,ag=y;if(ab){if(Z){T=(y*(X.getSouthWest().lat()-P.getSouthWest().lat())/Y);ag=y*(X.getNorthEast().lat()-X.getSouthWest().lat())/Y}else{T=0;ag=y*(X.getNorthEast().lat()-P.getSouthWest().lat())/Y}}else{if(Z){ag=(y*(P.getNorthEast().lat()-X.getSouthWest().lat())/Y);T=y-ag}else{}}W.style.bottom=T+"px";W.style.height=ag+"px";W.style.borderRight="solid 2px #FFFFFF";G.appendChild(W);G.border=W}}}G.style.backgroundImage="url('"+url+"')";G.style.width=Math.floor(U)+"px";G.style.height=af+"px"};N.updateClip();C(N,this.opacity);this.tiles.push(N);return N};x.prototype.releaseTile=function(H){var G=this.tiles.indexOf(H);if(G>-1){this.tiles.splice(G,1)}};x.prototype.setClip=function(G){G=Math.min(Math.max(G,0),1);this.clipBounds=new h.LatLngBounds(r.getSouthWest(),new h.LatLng(r.getNorthEast().lat(),r.getSouthWest().lng()+(r.getNorthEast().lng()-r.getSouthWest().lng())*G));this.updateTiles();this.updateMarker()};x.prototype.updateTiles=function(){var G;for(G=0;G<this.tiles.length;G++){this.tiles[G].updateClip()}};function C(H,G){G=Math.max(0,Math.min(G,1));H.style.opacity=G;H.style.filter="alpha(opacity="+(G*100)+")"}x.prototype.setOpacity=function(H){this.opacity=H;var G;for(G=0;G<this.tiles.length;G++){C(this.tiles[G],this.opacity)}};x.prototype.getOpacity=function(){return this.opacity};this._map=l;this._layer=new x(new h.Size(y,y));this._layer.displayCopyright=function(G){p.displayCopyright(m,G)};if(!A){p.overlaysArray.push(this)}}j.prototype.setClippedWidth=function(k){this._layer.setClip(k/100)};j.prototype.setVisible=function(m){var l=this._map.overlayMapTypes;var k=this.getMapIndex(this._layer);if(m){if(k==-1){a(l,this._layer);this._layer.displayCopyright(true)}}else{if(k!=-1){l.removeAt(k)}this._layer.displayCopyright(false)}};j.prototype.remove=function(){this.setVisible(false)};j.prototype.activateClipping=function(k){this._layer.activateClipping(k)};j.prototype.setOpacity=function(k){if(this._layer){this._layer.setOpacity(k)}};j.prototype.getOpacity=function(){if(this._layer){return this._layer.getOpacity()}else{return 1}};j.prototype.setToBottom=function(){this.setZIndex(0)};j.prototype.setOnTop=function(){var k=this._map.overlayMapTypes;this.setZIndex(k.length)};j.prototype.setZIndex=function(m){this._layer.zIndex=m;var k=this.getMapIndex(this._layer);if(k==-1){return}var l=this._map.overlayMapTypes;l.removeAt(k);a(l,this._layer)};j.prototype.getMapIndex=function(m){var n=this._map.overlayMapTypes;for(var l=0,k=n.length;l<k&&n.getAt(l)!=this._layer;++l){}return l==n.length?-1:l};j.prototype.getZIndex=function(){return this._layer.zIndex};return j})();c.uniWFSLayer=(function(){function j(l,r,t,u,s,k,q,n,v,p,w){var m=l.map;var x=t.indexOf("2.0.0")==0;if(!q){q=100}var o=r;o+="SERVICE=WFS";o+="&REQUEST=GetFeature";o+="&VERSION="+t;o+="&"+(x==true?"typeNames":"typeName")+"="+u;o+="&outputFormat=application/json";o+="&"+(x==true?"count":"maxFeatures")+"="+q;if(v){o+="&featureID="+v}if(p){o+="&propertyName="+p}if(w){o+="&sortBy="+w}o+="&srsName=EPSG:4326";this._bbox=m.getBounds().getSouthWest().lng()+","+m.getBounds().getSouthWest().lat()+","+m.getBounds().getNorthEast().lng()+","+m.getBounds().getNorthEast().lat();this._url=o;this._map=m;this._features=null;this._idPropertyName=n;this._featureID=v;this._visible;this._styleOptions=JSON.parse(k);this._styleFunction;that=this;b.addListener(m,"idle",function(){that._bbox=m.getBounds().getSouthWest().lng()+","+m.getBounds().getSouthWest().lat()+","+m.getBounds().getNorthEast().lng()+","+m.getBounds().getNorthEast().lat();if(that._visible){that.update()}});this.displayCopyright=function(y){l.displayCopyright(s,y)}}j.prototype.setVisible=function(k){this._visible=k;if(k){this.update();this.displayCopyright(true)}else{this.removeAll();this.displayCopyright(false)}};j.prototype.removeAll=function(){if(this._features!=null){for(var k=0;k<this._features.length;k++){this._map.data.remove(this._features[k])}}};j.prototype.update=function(){bbox="";if(!this._featureID){bbox="&bbox="+this._bbox}url=this._url+bbox;that=this;var k=new XMLHttpRequest();k.open("GET",url);k.onload=function(){var l=JSON.parse(k.responseText);that.removeAll();that._features=that._map.data.addGeoJson(l,{idPropertyName:that._idPropertyName});that.applyStyle()};k.send()};j.prototype.setFillOpacity=function(k){if(this._styleOptions){this._styleOptions.fillOpacity=k}this.applyStyle()};j.prototype.setStrokeOpacity=function(k){if(this._styleOptions){this._styleOptions.strokeOpacity=k}this.applyStyle()};j.prototype.getStrokeOpacity=function(){if(this._styleOptions){return this._styleOptions.strokeOpacity}else{return 1}};j.prototype.getFillOpacity=function(){if(this._styleOptions){return this._styleOptions.fillOpacity}else{return 1}};j.prototype.setToBottom=function(){this.setZIndex(0)};j.prototype.setOnTop=function(){var k=this._map.overlayMapTypes;this.setZIndex(k.length)};j.prototype.setZIndex=function(k){if(this._styleOptions){this._styleOptions.zIndex=k}this.applyStyle()};j.prototype.getZIndex=function(){if(this._styleOptions){this._styleOptions.zIndex=zIndex}return this._styleOptions.zIndex};j.prototype.setStyleFunction=function(k){this._styleFunction=k;this._map.data.setStyle(this._styleFunction);this._styleOptions=null};j.prototype.applyStyle=function(){if(this._features&&this._styleOptions){for(var k=0;k<this._features.length;k++){this._map.data.overrideStyle(this._features[k],this._styleOptions)}}};return j})();function a(l,m){var k;for(k=0;k<l.length;k++){var j=l.getAt(k);if(j.zIndex&&j.zIndex>m.zIndex){l.insertAt(k,m);return}}l.push(m)}c.codeAddress=function(j,k){if(!this.geocoder){this.geocoder=new h.Geocoder()}this.geocoder.geocode({address:j,partialmatch:true},function(o,m){if(m==h.GeocoderStatus.OK){var l=[];for(var n=0;n<o.length;n++){var q=o[n];var p=q.geometry.bounds;if(!p){p=q.geometry.viewport}l[n]={placeName:q.formatted_address,lat:q.geometry.location.lat(),lng:q.geometry.location.lng(),swlat:p.getSouthWest().lat(),swlng:p.getSouthWest().lng(),nelat:p.getNorthEast().lat(),nelng:p.getNorthEast().lng()}}k(l,m)}else{k(null,""+m)}})};c.getElevations=function(m,j,n){if(!this.elevationService){this.elevationService=new h.ElevationService()}var k;var l=[];for(k=0;k<m.length;){l.push(new h.LatLng(m[k],m[k+1]));k=k+2}this.elevationService.getElevationAlongPath({path:l,samples:j},function(q){if(q==null){n(null)}else{var o=[];for(var p=0;p<q.length;p++){o[p]={lat:q[p].location.lat(),lng:q[p].location.lng(),elevation:q[p].elevation}}n(o)}})};var d=(function(){function y(B,A){this.sex_=A||false;this.set("container",document.createElement("DIV"));this.setMap(B)}y.prototype=new google.maps.OverlayView();y.prototype.addDiv=function(A){this.get("container").appendChild(A)},y.prototype.decToSex=function(C){var A=Math.floor(C);var B=((Math.abs(C)-A)*60).toFixed(2);if(B=="60.00"){A+=1;B="0.00"}return[A,":",B].join("")};y.prototype.onAdd=function(){var B=this;this.getPanes().mapPane.appendChild(this.get("container"));function C(){B.draw()}this.idleHandler_=google.maps.event.addListener(this.getMap(),"idle",C);function A(){B.draw()}A();this.typeHandler_=google.maps.event.addListener(this.getMap(),"maptypeid_changed",A)};y.prototype.clear=function(){var A=this.get("container");while(A.hasChildNodes()){A.removeChild(A.firstChild)}};y.prototype.onRemove=function(){this.get("container").parentNode.removeChild(this.get("container"));this.set("container",null);google.maps.event.removeListener(this.idleHandler_);google.maps.event.removeListener(this.typeHandler_)};y.prototype.show=function(){this.get("container").style.visibility="visible"};y.prototype.hide=function(){this.get("container").style.visibility="hidden"};function v(C){var D=C.getMap().getMapTypeId();var A=google.maps.MapTypeId;if(D===A.HYBRID){return"#fff"}if(D===A.ROADMAP){return"#000"}if(D===A.SATELLITE){return"#fff"}if(D===A.TERRAIN){return"#000"}var B=C.getMap().mapTypes[D];return(B.textColor)?B.textColor:"#fff"}function x(A){if(A<0.01){return 3}if(A<0.1){return 2}if(A<1){return 1}return 0}function n(A,B,D){for(var C=0;C<B.length;C+=1){if(A<=B[C]){return B[C]}}return D}var j=10;var t=[0.06,0.12,0.3,0.6,1.2,3,6,12,30,60,60*2,60*5,60*10,60*20,60*30];var z=[0.01,0.02,0.05,0.1,0.2,0.5,1,3,6,12,30,60,60*2,60*5,60*10,60*20,60*30];function q(A){if(A.sex_){return z}return t}function l(B,C,A){return B.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(C,A))}function s(B,A){return n(Math.ceil(B/j*6000)/100,A,60*45)/60}function u(A){return A.toString()+"px"}function m(B,A,F,E){var D=document.createElement("DIV");var C=D.style;C.position="absolute";C.left=u(A);C.top=u(F);C.color=B;C.width="3em";C.fontSize="1.0em";C.whiteSpace="nowrap";D.innerHTML=E;return D}function p(A,G,B,E,C){var F=document.createElement("DIV");var D=F.style;D.position="absolute";D.overflow="hidden";D.backgroundColor=C;D.opacity=0.3;var D=F.style;D.left=u(A);D.top=u(G);D.width=u(B);D.height=u(E);return F}var w=50000;function k(B,A){return p(B,-w,1,2*w,A)}function o(B,A){return p(-w,B,2*w,1,A)}function r(B,A,C){if(!C){C=Math.pow(10,-6)}if(Math.abs(B-A)<C){return true}return false}y.prototype.draw=function(){var Q=v(this);this.clear();if(this.get("container").style.visibility!="visible"){return}var A=this.getMap().getBounds();if(!A){return}var O=A.getSouthWest(),E=A.getNorthEast();var P=O.lng(),S=O.lat(),N=E.lng(),K=E.lat();if(P==N){P=-180;N=180}if(K==S){S=-90;K=90}var F=q(this);var J=s(K-S,F);var D=s(N>P?N-P:((180-P)+(N+180)),F);P=Math.floor(P/D)*D;S=Math.floor(S/J)*J;K=Math.ceil(K/J)*J;N=Math.ceil(N/D)*D;if(N==P){P+=D}if(N<P){N+=360}var R=P+2*D;var H=l(this,S+2*J,P).y+2;for(var G=P;G<N;G+=D){if(G>180){N-=360;G-=360}var M=l(this,S,G).x;this.addDiv(k(M,Q));var C=r(G,R);this.addDiv(m(Q,M+(C?17:3),H-(C?3:0),(this.sex_?this.decToSex(G):G.toFixed(x(D)))))}var B=S+2*J;var I=l(this,S,P+2*D).x+3;for(;S<=K;S+=J){var L=l(this,S,P).y;this.addDiv(o(L,Q));this.addDiv(m(Q,I,L+(r(S,B)?7:2),(this.sex_?this.decToSex(S):S.toFixed(x(J)))))}};return y})();return c})();