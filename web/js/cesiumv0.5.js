var CesiumMaps=(function(){var c=Cesium.Ellipsoid.WGS84;function a(){}a.createMap=function(h,e,g,f,l,k,d){if(l==undefined){if(d){d("No valid div element provided")}}if(Cesium){var j=new a.Globe(l,h,e,g,f);k(j)}else{d()}};a.Globe=function(p,h,E,d,k,f,o){p.innerHTML="";p.style.position="relative";p.style.width="100%";p.style.height="100%";var s=document.createElement("div");s.style.width="100%";s.style.height="100%";p.appendChild(s);var v=document.createElement("div");v.style.position="absolute";v.style.right="0px";v.style.top="0px";p.appendChild(v);var F=mapsConfig!=undefined&&mapsConfig.bingMapsAPIKey!=undefined;if(!F){alert("Missing Bing Maps API key")}var A=F?mapsConfig.bingMapsAPIKey:undefined;var n={"Bing Satellite Maps":new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",key:A,mapStyle:Cesium.BingMapsStyle.AERIAL}),"Bing Road Maps":new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",key:A,mapStyle:Cesium.BingMapsStyle.ROAD})};var r=new Cesium.CesiumWidget(s,{imageryProvider:n[k?k:"Bing Satellite Maps"],scene3DOnly:true});var z=r.scene;this._scene=z;var j=new Cesium.CesiumTerrainProvider({url:"//assets.agi.com/stk-terrain/world",credit:"Terrain data courtesy Analytical Graphics, Inc."});z.terrainProvider=j;var D=new DrawHelper(r);this._drawHelper=D;var B=new InfoWindow({},r);z.primitives.add(B);var C=[];var e=r.scene.imageryLayers;function x(){return c.cartesianToCartographic(z.camera.position)}var w=this;w.setCenter=function(H,G){z.camera.setPositionCartographic(Cesium.Cartographic.fromDegrees(G,H,m()))};w.getCenter=function(){z.camera.lookDown();return a.convertPath([z.camera.position])};w.setZoomLevel=function(H){var G=x();G.height=y(H);z.camera.setPositionCartographic(G)};w.getZoomLevel=function(){return l(x().height)};w.getBounds=function(){var H=z.camera;H.lookDown();var K=z.canvas;var I=[H.pickEllipsoid(new Cesium.Cartesian2(0,0),c),H.pickEllipsoid(new Cesium.Cartesian2(K.width,0),c),H.pickEllipsoid(new Cesium.Cartesian2(0,K.height),c),H.pickEllipsoid(new Cesium.Cartesian2(K.width,K.height),c)];for(var J=0;J<4;J++){if(I[J]===undefined){var G=c.cartesianToCartographic(H.position);return a.convertBounds(Cesium.Rectangle.fromCartographicArray([new Cesium.Cartographic(G.longitude-Math.PI/2,Math.PI/2,0),new Cesium.Cartographic(G.longitude+Math.PI/2,Math.PI/2,0),new Cesium.Cartographic(G.longitude+Math.PI/2,-Math.PI/2,0),new Cesium.Cartographic(G.longitude-Math.PI/2,-Math.PI/2,0)]))}}return a.convertBounds(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(I)))};w.setBounds=function(I,G,J,H){z.camera.viewRectangle(Cesium.Rectangle.fromDegrees(G,I,H,J),c)};w.getMapTypeIds=function(){var G,H=[];for(G in n){H.push(G)}return H};w.getMapId=function(){return this._selectedMapId||"Bing Satellite Maps"};w.setMapId=function(G){if(G&&n[G]){this._selectedMapId=G;e.remove(e.get(0),false);e.add(new Cesium.ImageryLayer(n[G]))}};w.addMapType=function(L,J,M,I,K,N,G){var H=new a.TMSLayer(M,I,K);n[J]=H};w.addWMSMapType=function(K,R,H,M,J,L,T,I,N,O,Q,S,G,P){n[R]=b(this,H,M,J,L,T,I,N,O,Q,S)};w.addImageryLayer=function(G){e.add(G)};w.removeImageryLayer=function(H,G){e.remove(H,G)};w.moveLayerToBottom=function(G){e.lowerToBottom(G);e.raise(G)};w.moveLayerToTop=function(G){e.raiseToTop(G)};w.moveLayer=function(H,K){var G,I=e,J;G=I.indexOf(H);J=K-G;if(J>0){for(G=0;G<J;G++){I.raise(H)}}else{for(G=0;G<-J;G++){I.lower(H)}}};w.getLayerIndex=function(G){e.indexOf(G)};w.addControl=function(K,G){v.appendChild(K);var I=K.style.top!=""||K.style.right!=""||K.style.left!=""||K.style.bottom!="";if(G&&!I){v.style.top="";v.style.right="";var H=(s.offsetHeight/2)-(v.offsetHeight/2);var J=(s.offsetWidth/2)-(v.offsetWidth/2);if(G=="topLeft"){v.style.left="0px";v.style.top="0px"}if(G=="leftCenter"){v.style.left="0px";v.style.top=H+"px"}if(G=="bottomLeft"){v.style.left="0px";v.style.bottom="25px"}if(G=="bottomCenter"){v.style.left=J+"px";v.style.bottom="0px"}if(G=="bottomRight"){v.style.right="400px";v.style.bottom="0px"}if(G=="rightBottom"){v.style.right="0px";v.style.bottom="25px"}if(G=="rightCenter"){v.style.right="0px";v.style.top=H+"px"}if(G=="rightTop"){v.style.right="0px";v.style.top="25px"}if(G=="topRight"){v.style.right="0px";v.style.top="0px"}if(G=="topCenter"){v.style.left=J+"px";v.style.top="0px"}}};w.displayCoordinates=function(H){if(this.coordinatesOverlay==undefined){var G=this;var I=function(K){var L=document.createElement("DIV");L.innerHTML="";L.style.position="absolute";L.style.bottom="50px";L.style.left="0px";L.style.background="white";L.style.padding="10px";L.style.margin="10px";this.div_=L;K.appendChild(L);var J=new Cesium.ScreenSpaceEventHandler(z.canvas);J.setInputAction(function(M){var O=z.camera.pickEllipsoid(M.endPosition,c);if(O){var N=c.cartesianToCartographic(O);L.innerHTML="Position: (long: "+Cesium.Math.toDegrees(N.longitude).toFixed(5)+", lat: "+Cesium.Math.toDegrees(N.latitude).toFixed(5)+")"}else{L.innerHTML="Position: "}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};I.prototype.show=function(){this.div_.style.display="block"};I.prototype.hide=function(){this.div_.style.display="none"};this.coordinatesOverlay=new I(p);this.coordinatesOverlay.hide()}if(H){this.coordinatesOverlay.show()}else{this.coordinatesOverlay.hide()}};w.addZoomOnShift=function(I){var H=this;var G=this.map;p.parentElement.addEventListener("mousedown",function(J){if(J.shiftKey){J.preventDefault();J.stopPropagation();var K=z.camera.pickEllipsoid(new Cesium.Cartesian2(J.clientX,J.clientY),c);if(K){dragging=true;D.startDrawingZoomExtent(c.cartesianToCartographic(K),{strokeColor:"#ff0000",strokeOpacity:0.9,strokeThickness:1,fillColor:"#ffffff",fillOpacity:0.1,callback:function(L){I(Cesium.Math.toDegrees(L.south),Cesium.Math.toDegrees(L.west),Cesium.Math.toDegrees(L.north),Cesium.Math.toDegrees(L.east))}})}}},true)};w.openInfoWindow=function(I,G,H){B.showAt(G,I,"<div>"+H+"</div>")};w.openInfoWindowWidget=function(I,G,H){B.showAt(G,I,H)};w.closeInfoWindow=function(){B.hide()};w.removeMapType=function(G){};w.triggerResize=function(){};w.setVisible=function(G){};function t(H){var I=0;var G=0;if(H.offsetParent){do{I+=H.offsetLeft;G+=H.offsetTop}while(H=H.offsetParent)}return{x:I,y:G}}w.convertScreenPositionToEOLatLng=function(H,G){var I=t(p);return g(H-I.x,G-I.y)};w.convertLatLngToScreenPosition=function(H,G){var I=t(p)};w.displayRuler=function(G){};w.displayRulerAltitude=function(G){};w.displayCoordinatesGrid=function(H){if(H&&!this._gridOverlay){var G=new Graticule({tileWidth:512,tileHeight:512,numLines:10},z);e.addImageryProvider(G);this._gridOverlay=G}if(this._gridOverlay){this._gridOverlay.setVisible(H)}};w.setTooltip=function(G,H){D.setListener(G,"mouseMove",function(I){D._tooltip.showAt(I,H)})};w.setOnTop=function(G){z.primitives.raiseToTop(G)};w.sendToBack=function(G){z.primitives.lowerToBottom(G)};w.getIndex=function(G){var H=0;for(;H<z.primitives._primitives.length&&z.primitives._primitives[H]!==G;H++){}return H};w.cleanUp=function(){D.disableAllEditMode();if(C){for(var H=0;H<C.length;H++){var G=C[H];if(G.remove){G.remove()}}}C=[];this.closeInfoWindow()};w.addOverlay=function(G){C.push(G)};w.removeOverlay=function(H){for(var G=0;G<C.length&&C[G]!=H;G++){}if(G!=C.length){C.splice(G,1);if(H.remove){H.remove()}}};function g(I,H){var G=z.camera.pickEllipsoid(new Cesium.Cartesian2(I,H),c);if(G){return q(G)}else{return null}}w.setListener=function(H,G,I){H[G]=I};function m(){return c.cartesianToCartographic(z.camera.position).height}function q(H){var G=c.cartesianToCartographic(H);return{lng:Cesium.Math.toDegrees(G.longitude),lat:Cesium.Math.toDegrees(G.latitude),zoom:l(G.height)}}var u=360000000;function l(G){return Math.floor(Math.log(u/G)/Math.log(2))}function y(G){return u/Math.exp(G*Math.log(2))}};a.convertBounds=function(d){return{swLat:Cesium.Math.toDegrees(d.south),swLng:Cesium.Math.toDegrees(d.west),neLat:Cesium.Math.toDegrees(d.north),neLng:Cesium.Math.toDegrees(d.east)}};a.convertPath=function(d){var g=[],e;var f=c.cartesianArrayToCartographicArray(d);for(e=0;e<f.length;e++){g.push(Cesium.Math.toDegrees(f[e].latitude));g.push(Cesium.Math.toDegrees(f[e].longitude))}return g};a.generatePath=function(e){var d=[];for(i=0;i<e.length;){d.push(Cesium.Cartographic.fromDegrees(e[i+1],e[i],0));i=i+2}return c.cartographicArrayToCartesianArray(d)};a.getPathArea=function(d){return 0};a.getPathLength=function(d){return 0};a.uniMarker=function(l,j,e,f,h,g){this.globe=l;var d=new Cesium.BillboardCollection();l._scene.primitives.add(d);var k=d.add({show:true,position:c.cartographicToCartesian(Cesium.Cartographic.fromDegrees(e,j,10)),pixelOffset:new Cesium.Cartesian2(h?h:0,g?-g:0),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.RIGHT,verticalOrigin:Cesium.VerticalOrigin.TOP,scale:1,image:f,color:new Cesium.Color(1,1,1,1)});this.marker=k;l.addOverlay(this);this.remove=function(){if(!d.isDestroyed()){l._scene.primitives.remove(d)}}};a.uniMarker.prototype.setDraggable=function(e){this.marker.setEditable();var d=this;this.marker.addListener("dragEnd",function(){e(d)})};a.uniMarker.prototype.setListener=function(e,f){this.marker.setEditable();var d=this;this.marker.addListener(e,function(){f(d)})};a.uniMarker.prototype.setClickHandler=function(e){var d=this;this.globe._drawHelper.setListener(this.marker,"leftClick",function(f){e(d.getLat(),d.getLng())})};a.uniMarker.prototype.setVisible=function(d){this.marker.show=d};a.uniMarker.prototype._getPosition=function(){return c.cartesianToCartographic(this.marker.position)};a.uniMarker.prototype.getLat=function(){return Cesium.Math.toDegrees(this._getPosition().latitude)};a.uniMarker.prototype.getLng=function(){return Cesium.Math.toDegrees(this._getPosition().longitude)};a.uniMarker.prototype.setTitle=function(d){};a.uniMarker.prototype.setPosition=function(e,d){return this.marker.position=c.cartographicToCartesian(Cesium.Cartographic.fromDegrees(d,e,0))};a.createPoint=function(e,d){e._drawHelper.startDrawingMarker({callback:function(f){d(a.convertPath([f]))}})};a.createPolygon=function(k,g,n,l,f,j,m,h,o,d,e){k._drawHelper.startDrawingPolygon({strokeColor:g,strokeThickness:n,strokeOpacity:l,fillColor:f,fillOpacity:j,callback:function(p){o(a.convertPath(p))}})};a.uniPolygon=function(k,g,f){this.globe=k;if(g==undefined||g.length==undefined||g.length<6){return}var h=Cesium.Material.fromType(Cesium.Material.ColorType);var e=new DrawHelper.PolygonPrimitive({positions:a.generatePath(g),material:h});var j=f.callback;k._scene.primitives.add(e);k.addOverlay(this);var d=this;this.remove=function(){if(!e.isDestroyed()){e.setHighlighted&&e.setHighlighted(false);k._scene.primitives.remove(e)}};if(typeof j=="function"){e.setEditable();e.addListener("onEdited",function(l){j(a.convertPath(l.positions))})}this.setVisible=function(l){e.show=l;e.setEditMode&&e.setEditMode(false)};this.updatePositions=function(l){e.setPositions(a.generatePath(l))};this.getPositions=function(){return a.convertPath(e.getPositions())};this.getEOBounds=function(){return a.convertBounds(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getPositions())))};this.getArea=function(){return 0};this.setClickHandler=function(l){k._drawHelper.setListener(e,"leftClick",function(m){var o=k._scene.camera.pickEllipsoid(m,c);if(o){var n=a.convertPath([o]);l(n[0],n[1])}})};this.setEditable=function(l){e.setEditable()};this.setTooltip=function(l){k.setTooltip(e,l)};this.setStrokeStyle=function(l,m,n){l=Cesium.Color.fromCssColorString(l);l.alpha=m;this._strokeColor=l;this._strokeThickness=n;e.setStrokeStyle(l,n)};this.setFillColor=function(l){var m=Cesium.Color.fromCssColorString(l);if(!e.material.uniforms.color.equals(m)){e.material.uniforms.color=m}};this.setFillOpacity=function(l){if(e.material.uniforms.color.alpha!=l){e.material.uniforms.color.alpha=Math.max(0.004,l)}};this.sendToBack=function(){k.sendToBack(e)};this.setOnTop=function(){k.setOnTop(e)};this.setOnTop=function(){k.getIndex(e)};this._getCenter=function(){return Cesium.Rectangle.center(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getPositions())))};this.getCenter=function(){var l=this._getCenter();return[Cesium.Math.toDegrees(l.latitude),Cesium.Math.toDegrees(l.longitude)]};this.setCenter=function(s,o){e.setEditMode&&e.setEditMode(false);var l=this._getCenter();var m=Cesium.Math.toRadians(s)-l.latitude;var q=Cesium.Math.toRadians(o)-l.longitude;var n,p,r=c.cartesianArrayToCartographicArray(e.getPositions());for(n=0;n<r.length;n++){if(Math.abs(r[n].latitude+m)>Math.PI/2){return false}}for(n=0;n<r.length;n++){p=r[n];r[n]=new Cesium.Cartographic(p.longitude+q,p.latitude+m,0)}e.setPositions(c.cartographicArrayToCartesianArray(r));return true};this.setHighlighted=function(l){if(this._highlighted&&this._highlighted==l){return}if(l){e.setStrokeStyle(Cesium.Color.fromCssColorString("white"),this._strokeThickness)}else{e.setStrokeStyle(this._strokeColor,this._strokeThickness)}};this.forceSouthPole=function(){};this.setStrokeStyle(f.color||"#ffffff",f.opacity==undefined?1:f.opacity,f.thickness||2);this.setFillColor(f.fillColor||"#888888");this.setFillOpacity(f.fillOpacity==undefined?0.7:f.fillOpacity)};a.createCircle=function(k,g,n,l,f,j,m,h,o,d,e){k._drawHelper.startDrawingCircle({strokeColor:g,strokeThickness:n,strokeOpacity:l,fillColor:f,fillOpacity:j,callback:function(q,p){var q=c.cartesianToCartographic(q);o(Cesium.Math.toDegrees(q.latitude),Cesium.Math.toDegrees(q.longitude),p)}})};a.uniCircle=function(h,d,f,j,m){var k=Cesium.Material.fromType(Cesium.Material.ColorType);var e=new DrawHelper.CirclePrimitive({center:c.cartographicToCartesian(Cesium.Cartographic.fromDegrees(f,d)),radius:j,material:k});h._scene.primitives.add(e);h.addOverlay(this);this.remove=function(){if(!e.isDestroyed()){e.setHighlighted&&e.setHighlighted(false);h._scene.primitives.remove(e)}};var l=m.callback;if(l!=null&&typeof l=="function"){e.setEditable();e.addListener("onEdited",function(o){var n=c.cartesianToCartographic(o.center);l(Cesium.Math.toDegrees(n.latitude),Cesium.Math.toDegrees(n.longitude),o.radius)})}this.getRadius=function(){return e.getRadius()};this.setRadius=function(n){return e.setRadius(n)};function g(){return Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getCircleCartesianCoordinates(Cesium.Math.PI_OVER_SIX)))}this.getEOBounds=function(){return a.convertBounds(g())};this.getArea=function(){return 0};this.getCenter=function(){return a.convertPath([e.getCenter()])};this.setCenter=function(o,n){e.setEditMode&&e.setEditMode(false);e.setCenter(a.generatePath([o,n])[0]);return true};this.setClickHandler=function(n){h._drawHelper.setListener(e,"leftClick",function(o){var q=h._scene.camera.pickEllipsoid(o,c);if(q){var p=a.convertPath([q]);n(p[0],p[1])}})};this.setEditable=function(n){e.setEditable()};this.setTooltip=function(n){h.setTooltip(e,n)};this.setStrokeStyle=function(n,o,p){n=Cesium.Color.fromCssColorString(n);n.alpha=o;e.setStrokeStyle(n,p)};this.setFillColor=function(n){e.material.uniforms.color=Cesium.Color.fromCssColorString(n)};this.setFillOpacity=function(n){if(e.material.uniforms.color.alpha!=n){e.material.uniforms.color.alpha=Math.max(0.004,n)}};this.setVisible=function(n){e.show=n;e.setEditMode&&e.setEditMode(false)};this.sendToBack=function(){h.sendToBack(e)};this.setOnTop=function(){h.setOnTop(e)};this.setStrokeStyle(m.color||"#ffffff",m.opacity==undefined?1:m.opacity,m.thickness||2);this.setFillColor(m.fillColor||"#888888");this.setFillOpacity(m.fillOpacity==undefined?0.7:m.fillOpacity)};a.createRectangle=function(k,g,n,l,f,j,m,h,o,d,e){k._drawHelper.startDrawingExtent({strokeColor:g,strokeThickness:n,strokeOpacity:l,fillColor:f,fillOpacity:j,callback:function(p){o(Cesium.Math.toDegrees(p.south),Cesium.Math.toDegrees(p.west),Cesium.Math.toDegrees(p.north),Cesium.Math.toDegrees(p.east))}})};a.uniRectangle=function(j,g,h,e,f,m){var k=Cesium.Material.fromType(Cesium.Material.ColorType);var d=new DrawHelper.ExtentPrimitive({extent:Cesium.Rectangle.fromCartographicArray([Cesium.Cartographic.fromDegrees(h,g),Cesium.Cartographic.fromDegrees(f,e)]),material:k});j._scene.primitives.add(d);j.addOverlay(this);this.remove=function(){if(!d.isDestroyed()){d.setHighlighted&&d.setHighlighted(false);j._scene.primitives.remove(d)}};var l=m.callback;if(l!=null&&typeof l=="function"){d.setEditable();d.addListener("onEdited",function(n){l(Cesium.Math.toDegrees(n.extent.south),Cesium.Math.toDegrees(n.extent.west),Cesium.Math.toDegrees(n.extent.north),Cesium.Math.toDegrees(n.extent.east))})}j.addOverlay(this);this.getEOBounds=function(){return a.convertBounds(d.extent)};this.getArea=function(){return 0};this.getCenter=function(){var n=Cesium.Rectangle.center(d.extent);return[Cesium.Math.toDegrees(n.latitude),Cesium.Math.toDegrees(n.longitude)]};this.setCenter=function(s,p){d.setEditMode&&d.setEditMode(false);var q=d.extent;var n=Cesium.Rectangle.center(q);var o=Cesium.Math.toRadians(s)-n.latitude;var r=Cesium.Math.toRadians(p)-n.longitude;q.west+=r;q.east+=r;q.south+=o;q.north+=o;d.extent=q;return true};this.setClickHandler=function(n){j._drawHelper.setListener(d,"leftClick",function(o){var q=j._scene.camera.pickEllipsoid(o,c);if(q){var p=a.convertPath([q]);n(p[0],p[1])}})};this.setEditable=function(n){d.setEditable()};this.setTooltip=function(n){j.setTooltip(d,n)};this.setStrokeStyle=function(n,o,p){n=Cesium.Color.fromCssColorString(n);n.alpha=o;d.setStrokeStyle(n,p)};this.setFillColor=function(n){d.material.uniforms.color=Cesium.Color.fromCssColorString(n)};this.setFillOpacity=function(n){if(d.material.uniforms.color.alpha!=n){d.material.uniforms.color.alpha=Math.max(0.004,n)}};this.sendToBack=function(){j.sendToBack(d)};this.setOnTop=function(){j.setOnTop(d)};this.setBounds=function(q,o,p,n){d.extent.north=Cesium.Math.toRadians(q);d.extent.west=Cesium.Math.toRadians(n);d.extent.south=Cesium.Math.toRadians(p);d.extent.east=Cesium.Math.toRadians(o)};this.setVisible=function(n){d.show=n;d.setEditMode&&d.setEditMode(false)};this.setStrokeStyle(m.color||"#ffffff",m.opacity==undefined?1:m.opacity,m.thickness||2);this.setFillColor(m.fillColor||"#888888");this.setFillOpacity(m.fillOpacity==undefined?0.7:m.fillOpacity)};a.createPolyline=function(h,f,m,j,k,g,n,d,e,l){h._drawHelper.startDrawingPolyline({strokeColor:f,strokeThickness:m,strokeOpacity:j,callback:function(o){n(a.convertPath(o))}})};a.uniPolyline=function(k,o,g,p,l,m,h,j,f,n,d){if(o==undefined||o.length==undefined||o.length<6){return}var e=new DrawHelper.PolylinePrimitive({positions:a.generatePath(o),width:p});k._scene.primitives.add(e);if(typeof j=="function"){e.setEditable();e.addListener("onEdited",function(q){j(a.convertPath(q.positions))})}k.addOverlay(this);this.remove=function(){if(!e.isDestroyed()){e.setHighlighted&&e.setHighlighted(false);k._scene.primitives.remove(e)}};this.getLength=function(){return 0};this.setVisible=function(q){e.show=q;e.setEditMode&&e.setEditMode(false)};this.updatePositions=function(q){e.setPositions(a.generatePath(q))};this.getPositions=function(){return a.convertPath(e.getPositions())};this.getEOBounds=function(){return a.convertBounds(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getPositions())))};this.setClickHandler=function(q){k._drawHelper.setListener(e,"leftClick",function(r){var t=k._scene.camera.pickEllipsoid(r,c);if(t){var s=a.convertPath([t]);q(s[0],s[1])}})};this.setEditable=function(q){e.setEditable()};this.setTooltip=function(q){k.setTooltip(e,q)};this.setStrokeStyle=function(q,r,s){e.setWidth(s);e.appearance.material.uniforms.color=Cesium.Color.fromCssColorString(q);e.appearance.material.uniforms.color.alpha=r};this.sendToBack=function(){k.sendToBack(e)};this.setOnTop=function(){k.setOnTop(e)};this._getCenter=function(){return Cesium.Rectangle.center(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getPositions())))};this.getCenter=function(){var q=this._getCenter();return[Cesium.Math.toDegrees(q.latitude),Cesium.Math.toDegrees(q.longitude)]};this.setHighlighted=function(q){e.setHighlighted(q)};this.setCenter=function(x,t){e.setEditMode&&e.setEditMode(false);var q=this._getCenter();var r=Cesium.Math.toRadians(x)-q.latitude;var v=Cesium.Math.toRadians(t)-q.longitude;var s,u,w=c.cartesianArrayToCartographicArray(e.getPositions());for(s=0;s<w.length;s++){u=w[s];w[s]=new Cesium.Cartographic(u.longitude+v,u.latitude+r,0)}e.setPositions(c.cartographicArrayToCartesianArray(w));return true};this.setStrokeStyle(g,l,p)};a.uniRuler=function(j,m,g,n,k,h,l,d){if(m==undefined||m.length==undefined||m.length<4){return}var e=new DrawHelper.PolylinePrimitive({positions:a.generatePath(m),width:n});j._scene.primitives.add(e);e.setEditable();e.setEditMode(true);e.addListener("onEdited",function(o){h(a.convertPath(o.positions));e.setEditMode(true)});var f=e.setEditMode;e.setEditMode=function(){f(true)};j.addOverlay(this);this.remove=function(){if(!e.isDestroyed()){e.setHighlighted&&e.setHighlighted(false);j._scene.primitives.remove(e)}};this.setVisible=function(o){e.show=o;e.setEditMode&&e.setEditMode(false)};this.updatePositions=function(o){e.setPositions(a.generatePath(o))};this.getPositions=function(){return a.convertPath(e.getPositions())};this.getEOBounds=function(){return a.convertBounds(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getPositions())))};this.setEditable=function(o){e.setEditable()};this.setTooltip=function(o){j.setTooltip(e,o)};this.setStrokeStyle=function(o,p,q){e.setWidth(q);e.appearance.material.uniforms.color=Cesium.Color.fromCssColorString(o);e.appearance.material.uniforms.color.alpha=p};this.sendToBack=function(){j.sendToBack(e)};this.setOnTop=function(){j.setOnTop(e)};this._getCenter=function(){return Cesium.Rectangle.center(Cesium.Rectangle.fromCartographicArray(c.cartesianArrayToCartographicArray(e.getPositions())))};this.getCenter=function(){var o=this._getCenter();return[Cesium.Math.toDegrees(o.latitude),Cesium.Math.toDegrees(o.longitude)]}};a.uniLayer=function(){this.layer={}};a.uniLayer.prototype.setVisible=function(d){this.layer.show=d};a.uniLayer.prototype.remove=function(){this.globe.removeImageryLayer(this.layer,true)};a.uniLayer.prototype.setOpacity=function(d){this.layer.alpha=d};a.uniLayer.prototype.getOpacity=function(){return this.layer.alpha};a.uniLayer.prototype.setToBottom=function(){this.globe.moveLayerToBottom(this.layer)};a.uniLayer.prototype.setOnTop=function(){this.globe.moveLayerToTop(this.layer)};a.uniLayer.prototype.setZIndex=function(d){this.globe.moveLayer(this.layer,d+1)};a.uniLayer.prototype.getZIndex=function(){return this.globe.getLayerIndex(this.layer)};a.Proxy=function(g){if(!g){return}this.directURL=/^(?:[a-z]+:)?\/\//i.test(g)||(g.indexOf(window.location.protocol+"//"+window.location.host)==0);if(!this.directURL){var d=this;function e(k,h){var j=new XMLHttpRequest();if("withCredentials" in j){j.open(k,h,true)}else{if(typeof XDomainRequest!="undefined"){j=new XDomainRequest();j.open(k,h)}else{j=null}}return j}var f=e("GET",g);if(!f){return}f.onload=function(){d.directURL=true};f.onerror=function(){d.directURL=false};f.send()}};a.Proxy.prototype.getURL=function(d){if(this.directURL){return d}else{return"/proxy/?targetURL="+encodeURIComponent(d)}};a.TMSLayer=function(j,f,h,k,d,l,e){if(j.indexOf("$z")==-1){j=j+"/$z/$x/$y.png"}this._url=j;this._yFlip=h;this._proxy=new a.Proxy(this.formatUrl(0,0,0));this._tileDiscardPolicy=undefined;this._errorEvent=new Cesium.Event();this._credit=f&&f.length>0?new Cesium.Credit(f):undefined;this._tileWidth=256;this._tileHeight=256;this._minimumLevel=0;this._maximumLevel=18;this._tilingScheme=new Cesium.WebMercatorTilingScheme();if(k&&d&&l&&e){var g=new Cesium.Rectangle(Cesium.Math.toRadians(d),Cesium.Math.toRadians(k),Cesium.Math.toRadians(e),Cesium.Math.toRadians(l));g=Cesium.Rectangle.contains(this._tilingScheme.rectangle,g)?g:this._tilingScheme.rectangle;this._rectangle=g}else{this._rectangle=this._tilingScheme.rectangle}this._ready=true};a.TMSLayer.prototype=new Cesium.TileMapServiceImageryProvider();a.TMSLayer.prototype.formatUrl=function(d,f,e){return this._url.replace("$z",e).replace("$y",this._yFlip?f:(1<<e)-f-1).replace("$x",d)};a.TMSLayer.prototype.requestImage=function(d,f,e){return Cesium.ImageryProvider.loadImage(this,this._proxy.getURL(this.formatUrl(d,f,e)))};a.uniTMSLayer=function(e,f,g,d,h,j,l,m){var k=new a.TMSLayer(f,g,d,h,j,l,m);this.layer=new Cesium.ImageryLayer(k);e.addImageryLayer(this.layer);this.globe=e;this.globe.addOverlay(this)};a.uniTMSLayer.prototype=new a.uniLayer;function b(h,j,l,f,k,u,e,n,o,q,r){if(k==null||k==undefined){k=""}var p=new Cesium.WebMapServiceImageryProvider({url:j,layers:f,extent:new Cesium.Rectangle(Cesium.Math.toRadians(o),Cesium.Math.toRadians(n),Cesium.Math.toRadians(r),Cesium.Math.toRadians(q)),credit:k,enablePickFeatures:false});e="EPSG:4326";var t=l.indexOf("1.3")==0;var s=256;var g=j;g+="REQUEST=GetMap";g+="&SERVICE=WMS";g+="&VERSION="+l;g+="&LAYERS="+f;g+="&width="+s;g+="&height="+s;g+="&"+(t==true?"crs":"srs")+"="+e;g+="&TRANSPARENT=TRUE";if(u){g+="&styles="+u}g+="&format=image/png";var d=t==true&&e=="EPSG:4326";var m=new a.Proxy(g+"&BBOX=");p.requestImage=function(v,B,A){var z;var w=this._tilingScheme.tileXYToNativeRectangle(v,B,A);if(d){z=w.south+","+w.west+","+w.north+","+w.east}else{z=w.west+","+w.south+","+w.east+","+w.north}return Cesium.ImageryProvider.loadImage(this,m.getURL(g+"&BBOX="+z))};return p}a.uniWMSLayer=function(f,g,j,e,h,o,d,k,l,m,n){this.globe=f;this.layer=new Cesium.ImageryLayer(b(f,g,j,e,h,o,d,k,l,m,n));f.addImageryLayer(this.layer);this.globe.addOverlay(this)};a.uniWMSLayer.prototype=new a.uniLayer;a.uniWMSLayer.prototype.activateClipping=function(d){};return a})();var DrawHelper=(function(){var q=Cesium.Ellipsoid.WGS84;function y(z){this._scene=z.scene;this._tooltip=t(z.container);this._surfaces=[];this.initialiseHandlers();this.enhancePrimitives()}y.prototype.initialiseHandlers=function(){var D=this._scene;var z=this;var B=new Cesium.ScreenSpaceEventHandler(D.canvas);function C(F,E){if(z._handlersMuted==true){return}var G=D.pick(E);if(G&&G.primitive&&G.primitive[F]){G.primitive[F](E)}}B.setInputAction(function(E){C("leftClick",E.position)},Cesium.ScreenSpaceEventType.LEFT_CLICK);B.setInputAction(function(E){C("leftDoubleClick",E.position)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);var A;B.setInputAction(function(E){if(z._handlersMuted==true){return}var F=D.pick(E.endPosition);if(A&&(!F||A!=F.primitive)){!(A.isDestroyed&&A.isDestroyed())&&A.mouseOut(E.endPosition);A=null}if(F&&F.primitive){F=F.primitive;if(F.mouseOut){A=F}if(F.mouseMove){F.mouseMove(E.endPosition)}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE);B.setInputAction(function(E){C("leftUp",E.position)},Cesium.ScreenSpaceEventType.LEFT_UP);B.setInputAction(function(E){C("leftDown",E.position)},Cesium.ScreenSpaceEventType.LEFT_DOWN)};y.prototype.setListener=function(z,A,B){z[A]=B};y.prototype.muteHandlers=function(z){this._handlersMuted=z};y.prototype.registerEditableShape=function(A){var z=this;h(A,"mouseMove",function(B){A.setHighlighted(true);if(!A._editMode){z._tooltip.showAt(B,"Click to edit this shape")}});h(A,"mouseOut",function(B){A.setHighlighted(false);z._tooltip.setVisible(false)});h(A,"leftClick",function(B){A.setEditMode(true)})};y.prototype.startDrawing=function(z){this.disableAllEditMode();if(this.editCleanUp){this.editCleanUp()}this.editCleanUp=z;this.muteHandlers(true)};y.prototype.stopDrawing=function(){if(this.editCleanUp){this.editCleanUp();this.editCleanUp=null}this.muteHandlers(false)};y.prototype.disableAllHighlights=function(){this.setHighlighted(undefined)};y.prototype.setHighlighted=function(z){if(this._highlightedSurface&&!this._highlightedSurface.isDestroyed()&&this._highlightedSurface!=z){this._highlightedSurface.setHighlighted(false)}this._highlightedSurface=z};y.prototype.disableAllEditMode=function(){this.setEdited(undefined)};y.prototype.setEdited=function(z){if(this._editedSurface&&!this._editedSurface.isDestroyed()){this._editedSurface.setEditMode(false)}this._editedSurface=z};var l=Cesium.Material.fromType(Cesium.Material.ColorType);l.uniforms.color=new Cesium.Color(1,1,0,0.5);var f={ellipsoid:Cesium.Ellipsoid.WGS84,textureRotationAngle:0,height:0,asynchronous:true,show:true,debugShowBoundingVolume:false};var b=a(f,{appearance:new Cesium.EllipsoidSurfaceAppearance({aboveGround:false}),material:l,granularity:Math.PI/180});var r=a(f,{});var p=a(f,{});var d=a(f,{});var u=a(b,{rotation:0});var m=a(f,{width:5,geodesic:true,granularity:10000,appearance:new Cesium.PolylineMaterialAppearance({aboveGround:false}),material:l});var c=(function(){function z(){}z.prototype.initialiseOptions=function(A){s(this,A);this._ellipsoid=undefined;this._granularity=undefined;this._height=undefined;this._textureRotationAngle=undefined;this._id=undefined;this._createPrimitive=true;this._primitive=undefined;this._outlinePolygon=undefined};z.prototype.setAttribute=function(A,B){this[A]=B;this._createPrimitive=true};z.prototype.getAttribute=function(A){return this[A]};z.prototype.update=function(C,B,D){if(!Cesium.defined(this.ellipsoid)){throw new Cesium.DeveloperError("this.ellipsoid must be defined.")}if(!Cesium.defined(this.appearance)){throw new Cesium.DeveloperError("this.material must be defined.")}if(this.granularity<0){throw new Cesium.DeveloperError("this.granularity and scene2D/scene3D overrides must be greater than zero.")}if(!this.show){return}if(!this._createPrimitive&&(!Cesium.defined(this._primitive))){return}if(this._createPrimitive||(this._ellipsoid!==this.ellipsoid)||(this._granularity!==this.granularity)||(this._height!==this.height)||(this._textureRotationAngle!==this.textureRotationAngle)||(this._id!==this.id)){var E=this.getGeometry();if(!E){return}this._createPrimitive=false;this._ellipsoid=this.ellipsoid;this._granularity=this.granularity;this._height=this.height;this._textureRotationAngle=this.textureRotationAngle;this._id=this.id;this._primitive=this._primitive&&this._primitive.destroy();this._primitive=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:E,id:this.id,pickPrimitive:this}),appearance:this.appearance,asynchronous:this.asynchronous});this._outlinePolygon=this._outlinePolygon&&this._outlinePolygon.destroy();if(this.strokeColor&&this.getOutlineGeometry){this._outlinePolygon=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:this.getOutlineGeometry(),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(this.strokeColor)}}),appearance:new Cesium.PerInstanceColorAppearance({flat:true,renderState:{depthTest:{enabled:true}}})})}}var A=this._primitive;A.appearance.material=this.material;A.debugShowBoundingVolume=this.debugShowBoundingVolume;A.update(C,B,D);this._outlinePolygon&&this._outlinePolygon.update(C,B,D)};z.prototype.isDestroyed=function(){return false};z.prototype.destroy=function(){this._primitive=this._primitive&&this._primitive.destroy();return Cesium.destroyObject(this)};z.prototype.setStrokeStyle=function(A,B){if(!this.strokeColor||!this.strokeColor.equals(A)||this.strokeWidth!=B){this._createPrimitive=true;this.strokeColor=A;this.strokeWidth=B}};return z})();y.ExtentPrimitive=(function(){function z(A){if(!Cesium.defined(A.extent)){throw new Cesium.DeveloperError("Extent is required")}A=a(A,b);this.initialiseOptions(A);this.setExtent(A.extent)}z.prototype=new c();z.prototype.setExtent=function(A){this.setAttribute("extent",A)};z.prototype.getExtent=function(){return this.getAttribute("extent")};z.prototype.getGeometry=function(){if(!Cesium.defined(this.extent)){return}return new Cesium.RectangleGeometry({rectangle:this.extent,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})};z.prototype.getOutlineGeometry=function(){return new Cesium.RectangleOutlineGeometry({rectangle:this.extent})};return z})();y.PolygonPrimitive=(function(){function z(A){A=a(A,b);this.initialiseOptions(A);this.isPolygon=true}z.prototype=new c();z.prototype.setPositions=function(A){this.setAttribute("positions",A)};z.prototype.getPositions=function(){return this.getAttribute("positions")};z.prototype.getGeometry=function(){if(!Cesium.defined(this.positions)||this.positions.length<3){return}return Cesium.PolygonGeometry.fromPositions({positions:this.positions,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})};z.prototype.getOutlineGeometry=function(){return Cesium.PolygonOutlineGeometry.fromPositions({positions:this.getPositions()})};return z})();y.CirclePrimitive=(function(){function z(A){if(!(Cesium.defined(A.center)&&Cesium.defined(A.radius))){throw new Cesium.DeveloperError("Center and radius are required")}A=a(A,b);this.initialiseOptions(A);this.setRadius(A.radius)}z.prototype=new c();z.prototype.setCenter=function(A){this.setAttribute("center",A)};z.prototype.setRadius=function(A){this.setAttribute("radius",Math.max(0.1,A))};z.prototype.getCenter=function(){return this.getAttribute("center")};z.prototype.getRadius=function(){return this.getAttribute("radius")};z.prototype.getGeometry=function(){if(!(Cesium.defined(this.center)&&Cesium.defined(this.radius))){return}return new Cesium.CircleGeometry({center:this.center,radius:this.radius,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})};z.prototype.getOutlineGeometry=function(){return new Cesium.CircleOutlineGeometry({center:this.getCenter(),radius:this.getRadius()})};return z})();y.EllipsePrimitive=(function(){function z(A){if(!(Cesium.defined(A.center)&&Cesium.defined(A.semiMajorAxis)&&Cesium.defined(A.semiMinorAxis))){throw new Cesium.DeveloperError("Center and semi major and semi minor axis are required")}A=a(A,u);this.initialiseOptions(A)}z.prototype=new c();z.prototype.setCenter=function(A){this.setAttribute("center",A)};z.prototype.setSemiMajorAxis=function(A){if(A<this.getSemiMinorAxis()){return}this.setAttribute("semiMajorAxis",A)};z.prototype.setSemiMinorAxis=function(A){if(A>this.getSemiMajorAxis()){return}this.setAttribute("semiMinorAxis",A)};z.prototype.setRotation=function(A){return this.setAttribute("rotation",A)};z.prototype.getCenter=function(){return this.getAttribute("center")};z.prototype.getSemiMajorAxis=function(){return this.getAttribute("semiMajorAxis")};z.prototype.getSemiMinorAxis=function(){return this.getAttribute("semiMinorAxis")};z.prototype.getRotation=function(){return this.getAttribute("rotation")};z.prototype.getGeometry=function(){if(!(Cesium.defined(this.center)&&Cesium.defined(this.semiMajorAxis)&&Cesium.defined(this.semiMinorAxis))){return}return new Cesium.EllipseGeometry({ellipsoid:this.ellipsoid,center:this.center,semiMajorAxis:this.semiMajorAxis,semiMinorAxis:this.semiMinorAxis,rotation:this.rotation,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})};z.prototype.getOutlineGeometry=function(){return new Cesium.EllipseOutlineGeometry({center:this.getCenter(),semiMajorAxis:this.getSemiMajorAxis(),semiMinorAxis:this.getSemiMinorAxis(),rotation:this.getRotation()})};return z})();y.PolylinePrimitive=(function(){function z(A){A=a(A,m);this.initialiseOptions(A)}z.prototype=new c();z.prototype.setPositions=function(A){this.setAttribute("positions",A)};z.prototype.setWidth=function(A){this.setAttribute("width",A)};z.prototype.setGeodesic=function(A){this.setAttribute("geodesic",A)};z.prototype.getPositions=function(){return this.getAttribute("positions")};z.prototype.getWidth=function(){return this.getAttribute("width")};z.prototype.getGeodesic=function(A){return this.getAttribute("geodesic")};z.prototype.getGeometry=function(){if(!Cesium.defined(this.positions)||this.positions.length<2){return}return new Cesium.PolylineGeometry({positions:this.positions,height:this.height,width:this.width<1?1:this.width,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,ellipsoid:this.ellipsoid})};return z})();var w={iconUrl:"./img/dragIcon.png",shiftX:0,shiftY:0};var x={iconUrl:"./img/dragIcon.png",shiftX:0,shiftY:0};var o={iconUrl:"./img/dragIconLight.png",shiftX:0,shiftY:0};y.prototype.createBillboardGroup=function(A,z,B){var C=new y.BillboardGroup(this,z);C.addBillboards(A,B);return C};y.BillboardGroup=function(B,A){this._drawHelper=B;this._scene=B._scene;this._options=a(A,w);var z=new Cesium.BillboardCollection();this._scene.primitives.add(z);this._billboards=z;this._orderedBillboards=[]};y.BillboardGroup.prototype.createBillboard=function(A,C){var F=this._billboards.add({show:true,position:A,pixelOffset:new Cesium.Cartesian2(this._options.shiftX,this._options.shiftY),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,scale:1,image:this._options.iconUrl,color:new Cesium.Color(1,1,1,1)});if(C){var z=this;var E=this._scene.screenSpaceCameraController;function B(G){E.enableRotate=G}function D(){for(var H=0,G=z._orderedBillboards.length;H<G&&z._orderedBillboards[H]!=F;++H){}return H}if(C.dragHandlers){var z=this;h(F,"leftDown",function(G){function I(K){F.position=K;for(var M=0,L=z._orderedBillboards.length;M<L&&z._orderedBillboards[M]!=F;++M){}C.dragHandlers.onDrag&&C.dragHandlers.onDrag(D(),K)}function H(K){J.destroy();B(true);C.dragHandlers.onDragEnd&&C.dragHandlers.onDragEnd(D(),K)}var J=new Cesium.ScreenSpaceEventHandler(z._scene.canvas);J.setInputAction(function(K){var L=z._scene.camera.pickEllipsoid(K.endPosition,q);if(L){I(L)}else{H(L)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE);J.setInputAction(function(K){H(z._scene.camera.pickEllipsoid(K.position,q))},Cesium.ScreenSpaceEventType.LEFT_UP);B(false);C.dragHandlers.onDragStart&&C.dragHandlers.onDragStart(D(),z._scene.camera.pickEllipsoid(G,q))})}if(C.onDoubleClick){h(F,"leftDoubleClick",function(G){C.onDoubleClick(D())})}if(C.onClick){h(F,"leftClick",function(G){C.onClick(D())})}if(C.tooltip){h(F,"mouseMove",function(G){z._drawHelper._tooltip.showAt(G,C.tooltip())});h(F,"mouseOut",function(G){z._drawHelper._tooltip.setVisible(false)})}}return F};y.BillboardGroup.prototype.insertBillboard=function(A,z,B){this._orderedBillboards.splice(A,0,this.createBillboard(z,B))};y.BillboardGroup.prototype.addBillboard=function(z,A){this._orderedBillboards.push(this.createBillboard(z,A))};y.BillboardGroup.prototype.addBillboards=function(z,B){var A=0;for(;A<z.length;A++){this.addBillboard(z[A],B)}};y.BillboardGroup.prototype.updateBillboardsPositions=function(z){var A=0;for(;A<z.length;A++){this.getBillboard(A).position=z[A]}};y.BillboardGroup.prototype.countBillboards=function(){return this._orderedBillboards.length};y.BillboardGroup.prototype.getBillboard=function(z){return this._orderedBillboards[z]};y.BillboardGroup.prototype.removeBillboard=function(z){this._billboards.remove(this.getBillboard(z));this._orderedBillboards.splice(z,1)};y.BillboardGroup.prototype.remove=function(){this._billboards=this._billboards&&this._billboards.removeAll()&&this._billboards.destroy()};y.BillboardGroup.prototype.setOnTop=function(){this._scene.primitives.raiseToTop(this._billboards)};y.prototype.startDrawingMarker=function(A){var A=a(A,w);this.startDrawing(function(){E.remove();C.destroy();B.setVisible(false)});var z=this;var D=this._scene;var F=D.primitives;var B=this._tooltip;var E=new y.BillboardGroup(this,A);var C=new Cesium.ScreenSpaceEventHandler(D.canvas);C.setInputAction(function(G){if(G.position!=null){var H=D.camera.pickEllipsoid(G.position,q);if(H){E.addBillboard(H);z.stopDrawing();A.callback(H)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK);C.setInputAction(function(H){var G=H.endPosition;if(G!=null){var I=D.camera.pickEllipsoid(G,q);if(I){B.showAt(G,"<p>Click to add your marker. Position is: </p>"+e(q.cartesianToCartographic(I)))}else{B.showAt(G,"<p>Click on the globe to add your marker.</p>")}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};function n(B,z){var B=a(B,z);if(B.fillColor){B.material.uniforms.color=Cesium.Color.fromCssColorString(B.fillColor);B.material.uniforms.color.alpha=B.fillOpacity==undefined?0.5:B.fillOpacity}var A=Cesium.Color.fromCssColorString(B.strokeColor);A.alpha=B.strokeOpacity||1;B.strokeColor=A;return B}y.prototype.startDrawingPolygon=function(z){var z=a(z,b);this.startDrawingPolyshape(true,z)};y.prototype.startDrawingPolyline=function(z){var z=a(z,m);this.startDrawingPolyshape(false,z)};y.prototype.startDrawingPolyshape=function(B,J){var J=n(J,f);this.startDrawing(function(){H.remove(z);C.remove();G.destroy();I.setVisible(false)});var F=this;var E=this._scene;var H=E.primitives;var I=this._tooltip;var A=B?3:2;var z;if(B){z=new DrawHelper.PolygonPrimitive(J)}else{z=new DrawHelper.PolylinePrimitive(J)}z.setStrokeStyle(J.strokeColor,J.strokeThickness||2);z.asynchronous=false;H.add(z);var D=[];var C=new y.BillboardGroup(this,w);var G=new Cesium.ScreenSpaceEventHandler(E.canvas);G.setInputAction(function(K){if(K.position!=null){var L=E.camera.pickEllipsoid(K.position,q);if(L){if(D.length==0){D.push(L.clone());C.addBillboard(D[0])}if(D.length>=A){z.positions=D;z._createPrimitive=true}D.push(L);C.addBillboard(L)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK);G.setInputAction(function(L){var K=L.endPosition;if(K!=null){if(D.length==0){I.showAt(K,"<p>Click to add first point</p>")}else{var M=E.camera.pickEllipsoid(K,q);if(M){D.pop();M.y+=(1+Math.random());D.push(M);if(D.length>=A){z.positions=D;z._createPrimitive=true}C.getBillboard(D.length-1).position=M;I.showAt(K,"<p>Click to add new point ("+D.length+")</p>"+(D.length>A?"<p>Double click to finish drawing</p>":""))}}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE);G.setInputAction(function(L){var K=L.position;if(K!=null){if(D.length<A+2){return}else{var N=E.camera.pickEllipsoid(K,q);if(N){F.stopDrawing();if(typeof J.callback=="function"){var M=D.length-1;var O=Cesium.Math.EPSILON3;for(;M>0&&D[M].equalsEpsilon(D[M-1],O);M--){}J.callback(D.splice(0,M+1))}}}}},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)};function k(z){return q.cartographicArrayToCartesianArray([Cesium.Rectangle.northwest(z),Cesium.Rectangle.northeast(z),Cesium.Rectangle.southeast(z),Cesium.Rectangle.southwest(z)])}y.prototype.startDrawingExtent=function(I){var I=n(I,b);this.startDrawing(function(){if(G!=null){F.remove(G)}B.remove();E.destroy();H.setVisible(false)});var D=this;var C=this._scene;var F=this._scene.primitives;var H=this._tooltip;var z=null;var G=null;var B=null;var E=new Cesium.ScreenSpaceEventHandler(C.canvas);function A(K){if(G==null){I.extent=K;G=new DrawHelper.ExtentPrimitive(I);G.setStrokeStyle(I.strokeColor,I.strokeThickness);G.asynchronous=false;F.add(G)}G.setExtent(K);var J=k(K);if(B==null){B=new y.BillboardGroup(D,w);B.addBillboards(J)}else{B.updateBillboardsPositions(J)}}E.setInputAction(function(J){if(J.position!=null){var L=C.camera.pickEllipsoid(J.position,q);if(L){if(G==null){z=q.cartesianToCartographic(L);var K=j(z,z);A(K)}else{D.stopDrawing();if(typeof I.callback=="function"){I.callback(j(z,q.cartesianToCartographic(L)))}}}}},Cesium.ScreenSpaceEventType.LEFT_DOWN);E.setInputAction(function(K){var J=K.endPosition;if(J!=null){if(G==null){H.showAt(J,"<p>Click to start drawing rectangle</p>")}else{var M=C.camera.pickEllipsoid(J,q);if(M){var L=j(z,q.cartesianToCartographic(M));A(L);H.showAt(J,"<p>Drag to change rectangle extent</p><p>Click again to finish drawing</p>")}}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};y.prototype.startDrawingZoomExtent=function(F,J){var J=n(J,b);this.startDrawing(function(){if(H!=null){G.remove(H)}D.destroy();I.setVisible(false)});var C=this;var B=this._scene;var G=this._scene.primitives;var I=this._tooltip;var z=F;var H=null;var D=new Cesium.ScreenSpaceEventHandler(B.canvas);function A(K){if(H==null){J.extent=K;H=new DrawHelper.ExtentPrimitive(J);H.setStrokeStyle(J.strokeColor,J.strokeThickness);H.asynchronous=false;G.add(H)}H.setExtent(K)}D.setInputAction(function(K){if(K.position!=null){var L=B.camera.pickEllipsoid(K.position,q);if(L){C.stopDrawing();if(J.callback){J.callback(j(z,q.cartesianToCartographic(L)))}}}},Cesium.ScreenSpaceEventType.LEFT_UP);D.setInputAction(function(L){var K=L.endPosition;if(K!=null){var N=B.camera.pickEllipsoid(K,q);if(N){var M=j(z,q.cartesianToCartographic(N));A(M);I.showAt(K,"<p>Drag to change zoom extent</p><p>Release to zoom</p>")}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE);var E=j(z,z);A(E)};y.prototype.startDrawingCircle=function(H){var H=n(H,b);this.startDrawing(function A(){if(z!=null){F.remove(z)}B.remove();E.destroy();G.setVisible(false)});var D=this;var C=this._scene;var F=this._scene.primitives;var G=this._tooltip;var z=null;var B=null;var E=new Cesium.ScreenSpaceEventHandler(C.canvas);E.setInputAction(function(I){if(I.position!=null){var J=C.camera.pickEllipsoid(I.position,q);if(J){if(z==null){z=new y.CirclePrimitive({center:J,radius:0,asynchronous:false,material:H.material});z.setStrokeStyle(H.strokeColor,H.strokeThickness);F.add(z);B=new y.BillboardGroup(D,w);B.addBillboards([J])}else{if(typeof H.callback=="function"){H.callback(z.getCenter(),z.getRadius())}D.stopDrawing()}}}},Cesium.ScreenSpaceEventType.LEFT_DOWN);E.setInputAction(function(J){var I=J.endPosition;if(I!=null){if(z==null){G.showAt(I,"<p>Click to start drawing the circle</p>")}else{var K=C.camera.pickEllipsoid(I,q);if(K){z.setRadius(Cesium.Cartesian3.distance(z.getCenter(),K));B.updateBillboardsPositions(K);G.showAt(I,"<p>Move mouse to change circle radius</p><p>Click again to finish drawing</p>")}}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};y.prototype.enhancePrimitives=function(){var B=this;Cesium.Billboard.prototype.setEditable=function(){if(this._editable){return}this._editable=true;var E=this;var C=this;function D(F){B._scene.screenSpaceCameraController.enableRotate=F}h(E,"leftDown",function(F){function H(J){E.position=J;C.executeListeners({name:"drag",positions:J})}function G(J){I.destroy();D(true);C.executeListeners({name:"dragEnd",positions:J})}var I=new Cesium.ScreenSpaceEventHandler(B._scene.canvas);I.setInputAction(function(J){var K=B._scene.camera.pickEllipsoid(J.endPosition,q);if(K){H(K)}else{G(K)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE);I.setInputAction(function(J){G(B._scene.camera.pickEllipsoid(J.position,q))},Cesium.ScreenSpaceEventType.LEFT_UP);D(false)});g(E)};function z(C){var D=B._scene;if(this._highlighted&&this._highlighted==C){return}if(this._editMode===true){return}this._highlighted=C;if(C){B.setHighlighted(this);this._strokeColor=this.strokeColor;this.setStrokeStyle(Cesium.Color.fromCssColorString("white"),this.strokeWidth)}else{if(this._strokeColor){this.setStrokeStyle(this._strokeColor,this.strokeWidth)}else{this.setStrokeStyle(undefined,undefined)}}}function A(C){if(this._editMode==C){return}B.disableAllHighlights();if(C){B.setEdited(this);var J=B._scene;var N=this;if(this._markers==null){var H=new y.BillboardGroup(B,x);var G=new y.BillboardGroup(B,o);function M(Q,P){var R=Q-1<0?P.length-1:Q-1;if(R<G.countBillboards()){G.getBillboard(R).position=I(R)}R=Q;if(R<G.countBillboards()){G.getBillboard(R).position=I(R)}}function K(){N.executeListeners({name:"onEdited",positions:N.positions})}var O={dragHandlers:{onDrag:function(Q,P){N.positions[Q]=P;M(Q,N.positions);N._createPrimitive=true},onDragEnd:function(Q,P){N._createPrimitive=true;K()}},onDoubleClick:function(P){if(N.positions.length<4){return}N.positions.splice(P,1);N._createPrimitive=true;H.removeBillboard(P);G.removeBillboard(P);M(P,N.positions);K()},tooltip:function(){if(N.positions.length>3){return"Double click to remove this point"}}};H.addBillboards(N.positions,O);this._markers=H;function I(Q){var P=N.positions;return q.cartographicToCartesian(new Cesium.EllipsoidGeodesic(q.cartesianToCartographic(P[Q]),q.cartesianToCartographic(P[Q<P.length-1?Q+1:0])).interpolateUsingFraction(0.5))}var F=[];var L=0;var E=N.positions.length+(this.isPolygon?0:-1);for(;L<E;L++){F.push(I(L))}var D={dragHandlers:{onDragStart:function(Q,P){this.index=Q+1;N.positions.splice(this.index,0,P);N._createPrimitive=true},onDrag:function(Q,P){N.positions[this.index]=P;N._createPrimitive=true},onDragEnd:function(Q,P){H.insertBillboard(this.index,P,O);G.getBillboard(this.index-1).position=I(this.index-1);G.insertBillboard(this.index,I(this.index),D);N._createPrimitive=true;K()}},tooltip:function(){return"Drag to create a new point"}};G.addBillboards(F,D);this._editMarkers=G;this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(J.canvas);this._globeClickhandler.setInputAction(function(P){var Q=J.pick(P.position);if(!(Q&&Q.primitive)){N.setEditMode(false)}},Cesium.ScreenSpaceEventType.LEFT_CLICK);H.setOnTop();G.setOnTop()}this._editMode=true}else{if(this._markers!=null){this._markers.remove();this._editMarkers.remove();this._markers=null;this._editMarkers=null;this._globeClickhandler.destroy()}this._editMode=false}}DrawHelper.PolylinePrimitive.prototype.setEditable=function(){if(this.setEditMode){return}var C=this;C.isPolygon=false;C.asynchronous=false;B.registerEditableShape(C);C.setEditMode=A;var D=this.width;C.setHighlighted=function(E){if(this._editMode===true){return}if(E){B.setHighlighted(this);this.setWidth(D*2)}else{this.setWidth(D)}};C.getExtent=function(){return Cesium.Extent.fromCartographicArray(q.cartesianArrayToCartographicArray(this.positions))};g(C);C.setEditMode(false)};DrawHelper.PolygonPrimitive.prototype.setEditable=function(){var C=this;C.asynchronous=false;var D=B._scene;B.registerEditableShape(C);C.setEditMode=A;C.setHighlighted=z;g(C);C.setEditMode(false)};DrawHelper.ExtentPrimitive.prototype.setEditable=function(){if(this.setEditMode){return}var C=this;var D=B._scene;B.registerEditableShape(C);C.asynchronous=false;C.setEditMode=function(F){if(this._editMode==F){return}B.disableAllHighlights();if(F){B.setEdited(this);if(this._markers==null){var G=new y.BillboardGroup(B,x);function E(){C.executeListeners({name:"onEdited",extent:C.extent})}var H={dragHandlers:{onDrag:function(J,I){var K=G.getBillboard((J+2)%4).position;C.setExtent(j(q.cartesianToCartographic(K),q.cartesianToCartographic(I)));G.updateBillboardsPositions(k(C.extent))},onDragEnd:function(J,I){E()}},tooltip:function(){return"Drag to change the corners of this extent"}};G.addBillboards(k(C.extent),H);this._markers=G;this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(D.canvas);this._globeClickhandler.setInputAction(function(I){var J=D.pick(I.position);if(!(J&&!J.isDestroyed()&&J.primitive)){C.setEditMode(false)}},Cesium.ScreenSpaceEventType.LEFT_CLICK);G.setOnTop()}this._editMode=true}else{if(this._markers!=null){this._markers.remove();this._markers=null;this._globeClickhandler.destroy()}this._editMode=false}};C.setHighlighted=z;g(C);C.setEditMode(false)};y.EllipsePrimitive.prototype.setEditable=function(){if(this.setEditMode){return}var C=this;var D=B._scene;C.asynchronous=false;B.registerEditableShape(C);C.setEditMode=function(H){if(this._editMode==H){return}B.disableAllHighlights();if(H){B.setEdited(this);var E=this;if(this._markers==null){var I=new y.BillboardGroup(B,x);function G(){return Cesium.Shapes.computeEllipseBoundary(q,C.getCenter(),C.getSemiMajorAxis(),C.getSemiMinorAxis(),C.getRotation()+Math.PI/2,Math.PI/2).splice(0,4)}function F(){C.executeListeners({name:"onEdited",center:C.getCenter(),semiMajorAxis:C.getSemiMajorAxis(),semiMinorAxis:C.getSemiMinorAxis(),rotation:0})}var J={dragHandlers:{onDrag:function(L,K){var M=Cesium.Cartesian3.distance(C.getCenter(),K);if(L%2==0){C.setSemiMajorAxis(M)}else{C.setSemiMinorAxis(M)}I.updateBillboardsPositions(G())},onDragEnd:function(L,K){F()}},tooltip:function(){return"Drag to change the excentricity and radius"}};I.addBillboards(G(),J);this._markers=I;this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(D.canvas);this._globeClickhandler.setInputAction(function(K){var L=D.pick(K.position);if(!(L&&L.primitive)){E.setEditMode(false)}},Cesium.ScreenSpaceEventType.LEFT_CLICK);I.setOnTop()}this._editMode=true}else{if(this._markers!=null){this._markers.remove();this._markers=null;this._globeClickhandler.destroy()}this._editMode=false}};C.setHighlighted=z;g(C);C.setEditMode(false)};y.CirclePrimitive.prototype.getCircleCartesianCoordinates=function(G){var F=Cesium.CircleOutlineGeometry.createGeometry(new Cesium.CircleOutlineGeometry({ellipsoid:q,center:this.getCenter(),radius:this.getRadius(),granularity:G}));var D=0,E,C=[];for(;D<F.attributes.position.values.length;D+=3){E=F.attributes.position.values;C.push(new Cesium.Cartesian3(E[D],E[D+1],E[D+2]))}return C};y.CirclePrimitive.prototype.setEditable=function(){if(this.setEditMode){return}var D=this;var C=B._scene;D.asynchronous=false;B.registerEditableShape(D);D.setEditMode=function(H){if(this._editMode==H){return}B.disableAllHighlights();if(H){B.setEdited(this);var E=this;if(this._markers==null){var I=new y.BillboardGroup(B,x);function G(){return E.getCircleCartesianCoordinates(Cesium.Math.PI_OVER_TWO)}function F(){D.executeListeners({name:"onEdited",center:D.getCenter(),radius:D.getRadius()})}var J={dragHandlers:{onDrag:function(L,K){D.setRadius(Cesium.Cartesian3.distance(D.getCenter(),K));I.updateBillboardsPositions(G())},onDragEnd:function(L,K){F()}},tooltip:function(){return"Drag to change the radius"}};I.addBillboards(G(),J);this._markers=I;this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(C.canvas);this._globeClickhandler.setInputAction(function(K){var L=C.pick(K.position);if(!(L&&L.primitive)){E.setEditMode(false)}},Cesium.ScreenSpaceEventType.LEFT_CLICK);I.setOnTop()}this._editMode=true}else{if(this._markers!=null){this._markers.remove();this._markers=null;this._globeClickhandler.destroy()}this._editMode=false}};D.setHighlighted=z;g(D);D.setEditMode(false)}};y.DrawHelperWidget=(function(){function z(H,B){if(!(Cesium.defined(B.container))){throw new Cesium.DeveloperError("Container is required")}var F={markerIcon:"./img/glyphicons_242_google_maps.png",polylineIcon:"./img/glyphicons_097_vector_path_line.png",polygonIcon:"./img/glyphicons_096_vector_path_polygon.png",circleIcon:"./img/glyphicons_095_vector_path_circle.png",extentIcon:"./img/glyphicons_094_vector_path_square.png",clearIcon:"./img/glyphicons_067_cleaning.png",polylineDrawingOptions:m,polygonDrawingOptions:r,extentDrawingOptions:p,circleDrawingOptions:d};s(B,F);var A=this;var C=document.createElement("DIV");C.className="toolbar";B.container.appendChild(C);function E(O,I,L,N){var M=document.createElement("DIV");M.className="button";M.title=L;C.appendChild(M);M.onclick=N;var J=document.createElement("SPAN");M.appendChild(J);var K=document.createElement("IMG");K.src=I;J.appendChild(K);return M}var D=H._scene;E("marker",B.markerIcon,"Click to start drawing a 2D marker",function(){H.startDrawingMarker({callback:function(I){A.executeListeners({name:"markerCreated",position:I})}})});E("polyline",B.polylineIcon,"Click to start drawing a 2D polyline",function(){H.startDrawingPolyline({callback:function(I){A.executeListeners({name:"polylineCreated",positions:I})}})});E("polygon",B.polygonIcon,"Click to start drawing a 2D polygon",function(){H.startDrawingPolygon({callback:function(I){A.executeListeners({name:"polygonCreated",positions:I})}})});E("extent",B.extentIcon,"Click to start drawing an Extent",function(){H.startDrawingExtent({callback:function(I){A.executeListeners({name:"extentCreated",extent:I})}})});E("circle",B.circleIcon,"Click to start drawing a Circle",function(){H.startDrawingCircle({callback:function(J,I){A.executeListeners({name:"circleCreated",center:J,radius:I})}})});var G=document.createElement("DIV");G.className="divider";C.appendChild(G);E("clear",B.clearIcon,"Remove all primitives",function(){D.primitives.removeAll()});g(this)}return z})();y.prototype.addToolbar=function(z,A){A=a(A,{container:z});return new y.DrawHelperWidget(this,A)};function j(A,B){var z=new Cesium.Rectangle();z.west=Math.min(A.longitude,B.longitude);z.east=Math.max(A.longitude,B.longitude);z.south=Math.min(A.latitude,B.latitude);z.north=Math.max(A.latitude,B.latitude);var C=Cesium.Math.EPSILON7;if((z.east-z.west)<C){z.east+=C*2}if((z.north-z.south)<C){z.north+=C*2}return z}function t(A){var z=function(C){var E=document.createElement("DIV");E.className="twipsy right";var B=document.createElement("DIV");B.className="twipsy-arrow";E.appendChild(B);var D=document.createElement("DIV");D.className="twipsy-inner";E.appendChild(D);this._div=E;this._title=D;C.appendChild(E)};z.prototype.setVisible=function(B){this._div.style.display=B?"block":"none"};z.prototype.showAt=function(B,C){if(B&&C){this.setVisible(true);this._title.innerHTML=C;this._div.style.left=B.x+10+"px";this._div.style.top=(B.y-this._div.clientHeight/2)+"px"}};return new z(A)}function e(A,z){return A.longitude.toFixed(z||3)+", "+A.latitude.toFixed(z||3)}function v(B,A){if(B==null||typeof B!="object"){return B}if(B.constructor!=Object&&B.constructor!=Array){return B}if(B.constructor==Date||B.constructor==RegExp||B.constructor==Function||B.constructor==String||B.constructor==Number||B.constructor==Boolean){return new B.constructor(B)}A=A||new B.constructor();for(var z in B){A[z]=typeof A[z]=="undefined"?v(B[z],null):A[z]}return A}function s(A,z){A=A||{};var B;for(B in z){if(A[B]===undefined){A[B]=v(z[B])}}}function a(A,z){var C=v(A),B;for(B in z){if(C[B]===undefined){C[B]=v(z[B])}}return C}function h(z,A,B){z[A]=B}function g(z){z._listeners={};z.addListener=function(A,B){this._listeners[A]=(this._listeners[A]||[]);this._listeners[A].push(B);return this._listeners[A].length};z.executeListeners=function(B,C){if(this._listeners[B.name]&&this._listeners[B.name].length>0){var A=0;for(;A<this._listeners[B.name].length;A++){this._listeners[B.name][A](B)}}else{if(C){C(B)}}}}return y})();var Graticule=(function(){function b(j,h){var l={},k;for(k in j){l[k]=j[k]}for(k in h){if(l[k]===undefined){l[k]=h[k]}}return l}function e(j,k){j=j||{};this._tilingScheme=j.tilingScheme||new Cesium.GeographicTilingScheme();this._color=j.color||new Cesium.Color(1,1,1,0.4);this._tileWidth=j.tileWidth||256;this._tileHeight=j.tileHeight||256;this._ready=true;this._sexagesimal=j.sexagesimal||false;this._numLines=j.numLines||50;this._scene=k;this._labels=new Cesium.LabelCollection();k.primitives.add(this._labels);this._polylines=new Cesium.PolylineCollection();k.primitives.add(this._polylines);this._ellipsoid=k.globe.ellipsoid;var h=document.createElement("canvas");h.width=256;h.height=256;this._canvas=h}var d=(function(){try{return"x" in Object.defineProperty({},"x",{})}catch(h){return false}})();var c=Object.defineProperties;if(!d||!c){c=function(h){return h}}c(e.prototype,{url:{get:function(){return undefined}},proxy:{get:function(){return undefined}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}}});e.prototype.makeLabel=function(j,l,m,k,h){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new Cesium.Cartographic(j,l,10)),text:m,font:"normal",fillColor:"white",outlineColor:"white",style:Cesium.LabelStyle.FILL,pixelOffset:new Cesium.Cartesian2(5,k?5:-5),eyeOffset:Cesium.Cartesian3.ZERO,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:k?Cesium.VerticalOrigin.BOTTOM:Cesium.VerticalOrigin.TOP,scale:1})};e.prototype._drawGrid=function(t){if(this._currentExtent&&this._currentExtent.equals(t)){return}this._currentExtent=t;this._polylines.removeAll();this._labels.removeAll();var j=0;var p=this._canvasSize;var s=0,m=0,o;for(o=0;o<f.length&&s<((t.north-t.south)/10);o++){s=f[o]}for(o=0;o<f.length&&m<((t.east-t.west)/10);o++){m=f[o]}var y=(t.west<0?Math.ceil(t.west/m):Math.floor(t.west/m))*m;var k=(t.south<0?Math.ceil(t.south/s):Math.floor(t.south/s))*s;var q=(t.east<0?Math.ceil(t.east/s):Math.floor(t.east/s))*s;var x=(t.north<0?Math.ceil(t.north/m):Math.floor(t.north/m))*m;y=Math.max(y-2*m,-Math.PI);q=Math.min(q+2*m,Math.PI);k=Math.max(k-2*s,-Math.PI/2);x=Math.min(x+2*m,Math.PI/2);var w=this._ellipsoid;var n,A,h=Cesium.Math.toRadians(1);var z=k+Math.floor((x-k)/s/2)*s;for(A=y;A<q;A+=m){var u=[];for(n=k;n<x;n+=h){u.push(new Cesium.Cartographic(A,n))}u.push(new Cesium.Cartographic(A,x));this._polylines.add({positions:w.cartographicArrayToCartesianArray(u),width:1});var l=Cesium.Math.toDegrees(A);this.makeLabel(A,z,this._sexagesimal?this._decToSex(l):l.toFixed(a(m)),false)}var v=y+Math.floor((q-y)/m/2)*m;for(n=k;n<x;n+=s){var u=[];for(A=y;A<q;A+=h){u.push(new Cesium.Cartographic(A,n))}u.push(new Cesium.Cartographic(q,n));this._polylines.add({positions:w.cartographicArrayToCartesianArray(u),width:1});var r=Cesium.Math.toDegrees(n);this.makeLabel(v,n,this._sexagesimal?this._decToSex(r):r.toFixed(a(s)),true)}};e.prototype.requestImage=function(h,k,j){if(this._show){this._drawGrid(this._getExtentView())}return this._canvas};e.prototype.setVisible=function(h){this._show=h;if(!h){this._polylines.removeAll();this._labels.removeAll()}else{this._currentExtent=null;this._drawGrid(this._getExtentView())}};e.prototype.isVisible=function(){return this._show};e.prototype._decToSex=function(k){var h=Math.floor(k);var j=((Math.abs(k)-h)*60).toFixed(2);if(j=="60.00"){h+=1;j="0.00"}return[h,":",j].join("")};e.prototype._getExtentView=function(){var l=this._scene.camera;var k=this._scene.canvas;var h=[l.pickEllipsoid(new Cesium.Cartesian2(0,0),this._ellipsoid),l.pickEllipsoid(new Cesium.Cartesian2(k.width,0),this._ellipsoid),l.pickEllipsoid(new Cesium.Cartesian2(0,k.height),this._ellipsoid),l.pickEllipsoid(new Cesium.Cartesian2(k.width,k.height),this._ellipsoid)];for(var j=0;j<4;j++){if(h[j]===undefined){return Cesium.Rectangle.MAX_VALUE}}return Cesium.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(h))};function a(h){if(h<0.01){return 3}if(h<0.1){return 2}if(h<1){return 1}return 0}var f=[Cesium.Math.toRadians(0.05),Cesium.Math.toRadians(0.1),Cesium.Math.toRadians(0.2),Cesium.Math.toRadians(0.5),Cesium.Math.toRadians(1),Cesium.Math.toRadians(2),Cesium.Math.toRadians(5),Cesium.Math.toRadians(10)];function g(j){var h=document.getElementById("logging");h.innerHTML+=j}return e})();var InfoWindow=(function(){function a(e,d){var g={},f;for(f in e){g[f]=e[f]}for(f in d){if(g[f]===undefined){g[f]=d[f]}}return g}function b(g,e){g=g||{};this._scene=e.scene;var l=document.createElement("div");l.className="infoWindow";this._div=l;var k=document.createElement("div");k.className="frame";this._div.appendChild(k);var j=document.createElement("span");j.innerHTML="x";j.className="close";k.appendChild(j);var f=document.createElement("div");f.className="content";k.appendChild(f);var h=document.createElement("span");h.className="arrow";l.appendChild(h);e.container.appendChild(l);this._content=f;this._close=j;var d=this;this._close.onclick=function(){d.setVisible(false)};this.setVisible(true)}b.prototype.setVisible=function(d){this._visible=d;this._div.style.display=d?"block":"none"};b.prototype.setContent=function(d){if(typeof d=="string"){this._content.innerHTML=d}else{while(this._content.firstChild){this._content.removeChild(this._content.firstChild)}this._content.appendChild(d)}};b.prototype.setPosition=function(e,d){this._position=this._scene.globe.ellipsoid.cartographicToCartesian(Cesium.Cartographic.fromDegrees(e,d,0))};b.prototype.showAt=function(f,d,e){this.setPosition(f,d);this.setContent(e);this.setVisible(true)};b.prototype.hide=function(){this.setVisible(false)};b.prototype.update=function(e,d,f){if(!this._visible||!this._position){return}var g=Cesium.SceneTransforms.wgs84ToWindowCoordinates(this._scene,this._position);if(g){this._div.style.left=(Math.floor(g.x)-this._div.clientWidth/2)+"px";this._div.style.top=(Math.floor(g.y)-8-this._div.clientHeight)+"px"}};b.prototype.destroy=function(){this._div.parentNode.removeChild(this._div)};function c(e){var d=document.getElementById("logging");d.innerHTML=e}return b})();